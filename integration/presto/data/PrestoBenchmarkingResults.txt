
5.014 [ Query :Query(select
        l_returnflag,
        l_linestatus,
        sum(l_quantity) as sum_qty,
        sum(l_extendedprice) as sum_base_price,
        sum(l_extendedprice * (1 - l_discount)) as sum_disc_price,
        sum(l_extendedprice * (1 - l_discount) * (1 + l_tax)) as sum_charge,
        avg(l_quantity) as avg_qty,
        avg(l_extendedprice) as avg_price,
        avg(l_discount) as avg_disc,
        count(*) as count_order
from
        lineitem
where
        l_shipdate <= cast('1998-09-16' as timestamp)
group by
        l_returnflag,
        l_linestatus
order by
        l_returnflag,
        l_linestatus,,)
Time :5.014 ] 

 
7.608 [ Query :Query(select
        l_orderkey,
        sum(l_extendedprice * (1 - l_discount)) as revenue,
        o_orderdate,
        o_shippriority
from
        customer,
        orders,
        lineitem
where
        c_mktsegment = 'BUILDING'
        and c_custkey = o_custkey
        and l_orderkey = o_orderkey
        and o_orderdate <  cast('1995-03-22' as timestamp)
        and l_shipdate > cast('1995-03-22' as timestamp)
group by
        l_orderkey,
        o_orderdate,
        o_shippriority
order by
        revenue desc,
        o_orderdate
limit 10,,)
Time :7.608 ] 

 
4.62 [ Query :Query(select
        o_orderpriority,
        count(*) as order_count
from
        orders as o
where
        o_orderdate >= cast('1996-05-01' as timestamp)
        and o_orderdate < cast('1996-08-01' as timestamp)
        and exists (
                select
                        *
                from
                        lineitem
                where
                        l_orderkey = o.o_orderkey
                        and l_commitdate < l_receiptdate
        )
group by
        o_orderpriority
order by
        o_orderpriority,,)
Time :4.62 ] 

 
6.954 [ Query :Query(select
        n_name,
        sum(l_extendedprice * (1 - l_discount)) as revenue
from
        customer,
        orders,
        lineitem,
        supplier,
        nation,
        region
where
        c_custkey = o_custkey
        and l_orderkey = o_orderkey
        and l_suppkey = s_suppkey
        and c_nationkey = s_nationkey
        and s_nationkey = n_nationkey
        and n_regionkey = r_regionkey
        and r_name = 'AFRICA'
        and o_orderdate >= cast('1993-01-01' as timestamp)
        and o_orderdate < cast('1994-01-01' as timestamp)
group by
        n_name
order by
        revenue desc,,)
Time :6.954 ] 

 
3.312 [ Query :Query(select
        o_orderpriority,
        count(*) as order_count
from
        orders as o
where
        o_orderdate >= cast('1996-05-01' as timestamp)
        and o_orderdate < cast('1996-08-01' as timestamp)
        and exists (
                select
                        *
                from
                        lineitem
                where
                        l_orderkey = o.o_orderkey
                        and l_commitdate < l_receiptdate
        )
group by
        o_orderpriority
order by
        o_orderpriority,,)
Time :3.312 ] 

 
4.652 [ Query :Query(select
        n_name,
        sum(l_extendedprice * (1 - l_discount)) as revenue
from
        customer,
        orders,
        lineitem,
        supplier,
        nation,
        region
where
        c_custkey = o_custkey
        and l_orderkey = o_orderkey
        and l_suppkey = s_suppkey
        and c_nationkey = s_nationkey
        and s_nationkey = n_nationkey
        and n_regionkey = r_regionkey
        and r_name = 'AFRICA'
        and o_orderdate >= cast('1993-01-01' as timestamp)
        and o_orderdate < cast('1994-01-01' as timestamp) 
group by
        n_name
order by
        revenue desc,,)
Time :4.652 ] 

 
0.579 [ Query :Query(select
        sum(l_extendedprice * l_discount) as revenue
from
        lineitem
where
        l_shipdate >= cast('1993-01-01' as timestamp)
        and l_shipdate < cast('1994-01-01' as timestamp) 
        and l_discount between 0.06 - 0.01 and 0.06 + 0.01
        and l_quantity < 25,,)
Time :0.579 ] 

 
4.345 [ Query :Query(select
        supp_nation,
        cust_nation,
        l_year,
        sum(volume) as revenue
from
        (
                select
                        n1.n_name as supp_nation,
                        n2.n_name as cust_nation,
                        year(l_shipdate) as l_year,
                        l_extendedprice * (1 - l_discount) as volume
                from
                        supplier,
                        lineitem,
                        orders,
                        customer,
                        nation n1,
                        nation n2
                where
                        s_suppkey = l_suppkey
                        and o_orderkey = l_orderkey
                        and c_custkey = o_custkey
                        and s_nationkey = n1.n_nationkey
                        and c_nationkey = n2.n_nationkey
                        and (
                                (n1.n_name = 'KENYA' and n2.n_name = 'PERU')
                                or (n1.n_name = 'PERU' and n2.n_name = 'KENYA')
                        )
                        and l_shipdate between cast('1995-01-01' as timestamp) and cast('1996-12-31' as timestamp)
        ) as shipping
group by
        supp_nation,
        cust_nation,
        l_year
order by
        supp_nation,
        cust_nation,
        l_year,,)
Time :4.345 ] 

 
22.386 [ Query :Query(select
        o_year,
        sum(case
                when nation = 'PERU' then volume
                else 0
        end) / sum(volume) as mkt_share
from
        (
                select
                        year(o_orderdate) as o_year,
                        l_extendedprice * (1 - l_discount) as volume,
                        n2.n_name as nation
                from
                        part,
                        supplier,
                        lineitem,
                        orders,
                        customer,
                        nation n1,
                        nation n2,
                        region
                where
                        p_partkey = l_partkey
                        and s_suppkey = l_suppkey
                        and l_orderkey = o_orderkey
                        and o_custkey = c_custkey
                        and c_nationkey = n1.n_nationkey
                        and n1.n_regionkey = r_regionkey
                        and r_name = 'AMERICA'
                        and s_nationkey = n2.n_nationkey
                        and o_orderdate between cast('1995-01-01' as timestamp) and  cast('1996-12-31' as timestamp)
                        and p_type = 'ECONOMY BURNISHED NICKEL'
        ) as all_nations
group by
        o_year
order by
        o_year,,)
Time :22.386 ] 

 
4.902 [ Query :Query(select
        c_custkey,
        c_name,
        sum(l_extendedprice * (1 - l_discount)) as revenue,
        c_acctbal,
        n_name,
        c_address,
        c_phone,
        c_comment
from
        customer,
        orders,
        lineitem,
        nation
where
        c_custkey = o_custkey
        and l_orderkey = o_orderkey
        and o_orderdate >= cast('1993-07-01' as timestamp)
        and o_orderdate < cast('1993-10-01' as timestamp)
        and l_returnflag = 'R'
        and c_nationkey = n_nationkey
group by
        c_custkey,
        c_name,
        c_acctbal,
        c_phone,
        n_name,
        c_address,
        c_comment
order by
        revenue desc
limit 20,,)
Time :4.902 ] 

 
3.287 [ Query :Query(select
        l_shipmode,
        sum(case
                when o_orderpriority = '1-URGENT'
                        or o_orderpriority = '2-HIGH'
                        then 1
                else 0
        end) as high_line_count,
        sum(case
                when o_orderpriority <> '1-URGENT'
                        and o_orderpriority <> '2-HIGH'
                        then 1
                else 0
        end) as low_line_count
from
        orders,
        lineitem
where
        o_orderkey = l_orderkey
        and l_shipmode in ('REG AIR', 'MAIL')
        and l_commitdate < l_receiptdate
        and l_shipdate < l_commitdate
        and l_receiptdate >= cast('1995-01-01' as timestamp) 
        and l_receiptdate < cast('1996-01-01' as timestamp) 
group by
        l_shipmode
order by
        l_shipmode,,)
Time :3.287 ] 

 
8.689 [ Query :Query(select
        c_count,
        count(*) as custdist
from
        (
                select
                        c_custkey,
                        count(o_orderkey) as c_count
                from
                        customer left outer join orders on
                                c_custkey = o_custkey
                                and o_comment not like '%unusual%accounts%'
                group by
                        c_custkey
        ) c_orders
group by
        c_count
order by
        custdist desc,
        c_count desc,,)
Time :8.689 ] 

 
0.835 [ Query :Query(select
        100.00 * sum(case
                when p_type like 'PROMO%'
                        then l_extendedprice * (1 - l_discount)
                else 0
        end) / sum(l_extendedprice * (1 - l_discount)) as promo_revenue
from
        lineitem,
        part
where
        l_partkey = p_partkey
        and l_shipdate >= cast('1995-08-01' as timestamp) 
        and l_shipdate < cast('1995-09-01' as timestamp),,)
Time :0.835 ] 

 
4.304 [ Query :Query(select
        p_brand,
        p_type,
        p_size,
        count(distinct ps_suppkey) as supplier_cnt
from
        partsupp,
        part
where
        p_partkey = ps_partkey
        and p_brand <> 'Brand#34'
        and p_type not like 'ECONOMY BRUSHED%'
        and p_size in (22, 14, 27, 49, 21, 33, 35, 28)
        and partsupp.ps_suppkey not in (
                select
                        s_suppkey
                from
                        supplier
                where
                        s_comment like '%Customer%Complaints%'
        )
group by
        p_brand,
        p_type,
        p_size
order by
        supplier_cnt desc,
        p_brand,
        p_type,
        p_size,,)
Time :4.304 ] 

 
0.623 [ Query :Query(with q17_part as (
  select p_partkey from part where  
  p_brand = 'Brand#23'
  and p_container = 'MED BOX'
),
q17_avg as (
  select l_partkey as t_partkey, 0.2 * avg(l_quantity) as t_avg_quantity
  from lineitem 
  where l_partkey IN (select p_partkey from q17_part)
  group by l_partkey
),
q17_price as (
  select
  l_quantity,
  l_partkey,
  l_extendedprice
  from
  lineitem
  where
  l_partkey IN (select p_partkey from q17_part)
)
select cast(sum(l_extendedprice) / 7.0 as decimal(32,2)) as avg_yearly
from q17_avg, q17_price
where 
t_partkey = l_partkey and l_quantity < t_avg_quantity,,)
Time :0.623 ] 

 
2.702 [ Query :Query(-- explain formatted 
with tmp1 as (
    select p_partkey from part where p_name like 'forest%'
),
tmp2 as (
    select s_name, s_address, s_suppkey
    from supplier, nation
    where s_nationkey = n_nationkey
    and n_name = 'CANADA'
),
tmp3 as (
    select l_partkey, 0.5 * sum(l_quantity) as sum_quantity, l_suppkey
    from lineitem, tmp2
    where l_shipdate >= cast('1994-01-01' as timestamp) and l_shipdate <= cast('1995-01-01' as timestamp)
    and l_suppkey = s_suppkey 
    group by l_partkey, l_suppkey
),
tmp4 as (
    select ps_partkey, ps_suppkey, ps_availqty
    from partsupp 
    where ps_partkey IN (select p_partkey from tmp1)
),
tmp5 as (
select
    ps_suppkey
from
    tmp4, tmp3
where
    ps_partkey = l_partkey
    and ps_suppkey = l_suppkey
    and ps_availqty > sum_quantity
)
select
    s_name,
    s_address
from
    supplier
where
    s_suppkey IN (select ps_suppkey from tmp5)
order by s_name,,)
Time :2.702 ] 

 
8.035 [ Query :Query(select
        l_returnflag,
        l_linestatus,
        sum(l_quantity) as sum_qty,
        sum(l_extendedprice) as sum_base_price,
        sum(l_extendedprice * (1 - l_discount)) as sum_disc_price,
        sum(l_extendedprice * (1 - l_discount) * (1 + l_tax)) as sum_charge,
        avg(l_quantity) as avg_qty,
        avg(l_extendedprice) as avg_price,
        avg(l_discount) as avg_disc,
        count(*) as count_order
from
        lineitem
where
        l_shipdate <= cast('1998-09-16' as timestamp)
group by
        l_returnflag,
        l_linestatus
order by
        l_returnflag,
        l_linestatus,,)
Time :8.035 ] 

 
7.172 [ Query :Query(select
        l_orderkey,
        sum(l_extendedprice * (1 - l_discount)) as revenue,
        o_orderdate,
        o_shippriority
from
        customer,
        orders,
        lineitem
where
        c_mktsegment = 'BUILDING'
        and c_custkey = o_custkey
        and l_orderkey = o_orderkey
        and o_orderdate <  cast('1995-03-22' as timestamp)
        and l_shipdate > cast('1995-03-22' as timestamp)
group by
        l_orderkey,
        o_orderdate,
        o_shippriority
order by
        revenue desc,
        o_orderdate
limit 10,,)
Time :7.172 ] 

 
4.278 [ Query :Query(select
        o_orderpriority,
        count(*) as order_count
from
        orders as o
where
        o_orderdate >= cast('1996-05-01' as timestamp)
        and o_orderdate < cast('1996-08-01' as timestamp)
        and exists (
                select
                        *
                from
                        lineitem
                where
                        l_orderkey = o.o_orderkey
                        and l_commitdate < l_receiptdate
        )
group by
        o_orderpriority
order by
        o_orderpriority,,)
Time :4.278 ] 

 
5.096 [ Query :Query(select
        n_name,
        sum(l_extendedprice * (1 - l_discount)) as revenue
from
        customer,
        orders,
        lineitem,
        supplier,
        nation,
        region
where
        c_custkey = o_custkey
        and l_orderkey = o_orderkey
        and l_suppkey = s_suppkey
        and c_nationkey = s_nationkey
        and s_nationkey = n_nationkey
        and n_regionkey = r_regionkey
        and r_name = 'AFRICA'
        and o_orderdate >= cast('1993-01-01' as timestamp)
        and o_orderdate < cast('1994-01-01' as timestamp)
group by
        n_name
order by
        revenue desc,,)
Time :5.096 ] 

 
3.3 [ Query :Query(select
        o_orderpriority,
        count(*) as order_count
from
        orders as o
where
        o_orderdate >= cast('1996-05-01' as timestamp)
        and o_orderdate < cast('1996-08-01' as timestamp)
        and exists (
                select
                        *
                from
                        lineitem
                where
                        l_orderkey = o.o_orderkey
                        and l_commitdate < l_receiptdate
        )
group by
        o_orderpriority
order by
        o_orderpriority,,)
Time :3.3 ] 

 
4.067 [ Query :Query(select
        n_name,
        sum(l_extendedprice * (1 - l_discount)) as revenue
from
        customer,
        orders,
        lineitem,
        supplier,
        nation,
        region
where
        c_custkey = o_custkey
        and l_orderkey = o_orderkey
        and l_suppkey = s_suppkey
        and c_nationkey = s_nationkey
        and s_nationkey = n_nationkey
        and n_regionkey = r_regionkey
        and r_name = 'AFRICA'
        and o_orderdate >= cast('1993-01-01' as timestamp)
        and o_orderdate < cast('1994-01-01' as timestamp) 
group by
        n_name
order by
        revenue desc,,)
Time :4.067 ] 

 
0.324 [ Query :Query(select
        sum(l_extendedprice * l_discount) as revenue
from
        lineitem
where
        l_shipdate >= cast('1993-01-01' as timestamp)
        and l_shipdate < cast('1994-01-01' as timestamp) 
        and l_discount between 0.06 - 0.01 and 0.06 + 0.01
        and l_quantity < 25,,)
Time :0.324 ] 

 
4.375 [ Query :Query(select
        supp_nation,
        cust_nation,
        l_year,
        sum(volume) as revenue
from
        (
                select
                        n1.n_name as supp_nation,
                        n2.n_name as cust_nation,
                        year(l_shipdate) as l_year,
                        l_extendedprice * (1 - l_discount) as volume
                from
                        supplier,
                        lineitem,
                        orders,
                        customer,
                        nation n1,
                        nation n2
                where
                        s_suppkey = l_suppkey
                        and o_orderkey = l_orderkey
                        and c_custkey = o_custkey
                        and s_nationkey = n1.n_nationkey
                        and c_nationkey = n2.n_nationkey
                        and (
                                (n1.n_name = 'KENYA' and n2.n_name = 'PERU')
                                or (n1.n_name = 'PERU' and n2.n_name = 'KENYA')
                        )
                        and l_shipdate between cast('1995-01-01' as timestamp) and cast('1996-12-31' as timestamp)
        ) as shipping
group by
        supp_nation,
        cust_nation,
        l_year
order by
        supp_nation,
        cust_nation,
        l_year,,)
Time :4.375 ] 

 
19.616 [ Query :Query(select
        o_year,
        sum(case
                when nation = 'PERU' then volume
                else 0
        end) / sum(volume) as mkt_share
from
        (
                select
                        year(o_orderdate) as o_year,
                        l_extendedprice * (1 - l_discount) as volume,
                        n2.n_name as nation
                from
                        part,
                        supplier,
                        lineitem,
                        orders,
                        customer,
                        nation n1,
                        nation n2,
                        region
                where
                        p_partkey = l_partkey
                        and s_suppkey = l_suppkey
                        and l_orderkey = o_orderkey
                        and o_custkey = c_custkey
                        and c_nationkey = n1.n_nationkey
                        and n1.n_regionkey = r_regionkey
                        and r_name = 'AMERICA'
                        and s_nationkey = n2.n_nationkey
                        and o_orderdate between cast('1995-01-01' as timestamp) and  cast('1996-12-31' as timestamp)
                        and p_type = 'ECONOMY BURNISHED NICKEL'
        ) as all_nations
group by
        o_year
order by
        o_year,,)
Time :19.616 ] 

 
4.633 [ Query :Query(select
        c_custkey,
        c_name,
        sum(l_extendedprice * (1 - l_discount)) as revenue,
        c_acctbal,
        n_name,
        c_address,
        c_phone,
        c_comment
from
        customer,
        orders,
        lineitem,
        nation
where
        c_custkey = o_custkey
        and l_orderkey = o_orderkey
        and o_orderdate >= cast('1993-07-01' as timestamp)
        and o_orderdate < cast('1993-10-01' as timestamp)
        and l_returnflag = 'R'
        and c_nationkey = n_nationkey
group by
        c_custkey,
        c_name,
        c_acctbal,
        c_phone,
        n_name,
        c_address,
        c_comment
order by
        revenue desc
limit 20,,)
Time :4.633 ] 

 
3.91 [ Query :Query(select
        l_shipmode,
        sum(case
                when o_orderpriority = '1-URGENT'
                        or o_orderpriority = '2-HIGH'
                        then 1
                else 0
        end) as high_line_count,
        sum(case
                when o_orderpriority <> '1-URGENT'
                        and o_orderpriority <> '2-HIGH'
                        then 1
                else 0
        end) as low_line_count
from
        orders,
        lineitem
where
        o_orderkey = l_orderkey
        and l_shipmode in ('REG AIR', 'MAIL')
        and l_commitdate < l_receiptdate
        and l_shipdate < l_commitdate
        and l_receiptdate >= cast('1995-01-01' as timestamp) 
        and l_receiptdate < cast('1996-01-01' as timestamp) 
group by
        l_shipmode
order by
        l_shipmode,,)
Time :3.91 ] 

 
7.404 [ Query :Query(select
        c_count,
        count(*) as custdist
from
        (
                select
                        c_custkey,
                        count(o_orderkey) as c_count
                from
                        customer left outer join orders on
                                c_custkey = o_custkey
                                and o_comment not like '%unusual%accounts%'
                group by
                        c_custkey
        ) c_orders
group by
        c_count
order by
        custdist desc,
        c_count desc,,)
Time :7.404 ] 

 
0.791 [ Query :Query(select
        100.00 * sum(case
                when p_type like 'PROMO%'
                        then l_extendedprice * (1 - l_discount)
                else 0
        end) / sum(l_extendedprice * (1 - l_discount)) as promo_revenue
from
        lineitem,
        part
where
        l_partkey = p_partkey
        and l_shipdate >= cast('1995-08-01' as timestamp) 
        and l_shipdate < cast('1995-09-01' as timestamp),,)
Time :0.791 ] 

 
3.024 [ Query :Query(select
        p_brand,
        p_type,
        p_size,
        count(distinct ps_suppkey) as supplier_cnt
from
        partsupp,
        part
where
        p_partkey = ps_partkey
        and p_brand <> 'Brand#34'
        and p_type not like 'ECONOMY BRUSHED%'
        and p_size in (22, 14, 27, 49, 21, 33, 35, 28)
        and partsupp.ps_suppkey not in (
                select
                        s_suppkey
                from
                        supplier
                where
                        s_comment like '%Customer%Complaints%'
        )
group by
        p_brand,
        p_type,
        p_size
order by
        supplier_cnt desc,
        p_brand,
        p_type,
        p_size,,)
Time :3.024 ] 

 
0.498 [ Query :Query(with q17_part as (
  select p_partkey from part where  
  p_brand = 'Brand#23'
  and p_container = 'MED BOX'
),
q17_avg as (
  select l_partkey as t_partkey, 0.2 * avg(l_quantity) as t_avg_quantity
  from lineitem 
  where l_partkey IN (select p_partkey from q17_part)
  group by l_partkey
),
q17_price as (
  select
  l_quantity,
  l_partkey,
  l_extendedprice
  from
  lineitem
  where
  l_partkey IN (select p_partkey from q17_part)
)
select cast(sum(l_extendedprice) / 7.0 as decimal(32,2)) as avg_yearly
from q17_avg, q17_price
where 
t_partkey = l_partkey and l_quantity < t_avg_quantity,,)
Time :0.498 ] 

 
2.865 [ Query :Query(-- explain formatted 
with tmp1 as (
    select p_partkey from part where p_name like 'forest%'
),
tmp2 as (
    select s_name, s_address, s_suppkey
    from supplier, nation
    where s_nationkey = n_nationkey
    and n_name = 'CANADA'
),
tmp3 as (
    select l_partkey, 0.5 * sum(l_quantity) as sum_quantity, l_suppkey
    from lineitem, tmp2
    where l_shipdate >= cast('1994-01-01' as timestamp) and l_shipdate <= cast('1995-01-01' as timestamp)
    and l_suppkey = s_suppkey 
    group by l_partkey, l_suppkey
),
tmp4 as (
    select ps_partkey, ps_suppkey, ps_availqty
    from partsupp 
    where ps_partkey IN (select p_partkey from tmp1)
),
tmp5 as (
select
    ps_suppkey
from
    tmp4, tmp3
where
    ps_partkey = l_partkey
    and ps_suppkey = l_suppkey
    and ps_availqty > sum_quantity
)
select
    s_name,
    s_address
from
    supplier
where
    s_suppkey IN (select ps_suppkey from tmp5)
order by s_name,,)
Time :2.865 ] 

 
6.102 [ Query :Query(select
        l_returnflag,
        l_linestatus,
        sum(l_quantity) as sum_qty,
        sum(l_extendedprice) as sum_base_price,
        sum(l_extendedprice * (1 - l_discount)) as sum_disc_price,
        sum(l_extendedprice * (1 - l_discount) * (1 + l_tax)) as sum_charge,
        avg(l_quantity) as avg_qty,
        avg(l_extendedprice) as avg_price,
        avg(l_discount) as avg_disc,
        count(*) as count_order
from
        lineitem
where
        l_shipdate <= cast('1998-09-16' as timestamp)
group by
        l_returnflag,
        l_linestatus
order by
        l_returnflag,
        l_linestatus,,)
Time :6.102 ] 

 
6.896 [ Query :Query(select
        l_orderkey,
        sum(l_extendedprice * (1 - l_discount)) as revenue,
        o_orderdate,
        o_shippriority
from
        customer,
        orders,
        lineitem
where
        c_mktsegment = 'BUILDING'
        and c_custkey = o_custkey
        and l_orderkey = o_orderkey
        and o_orderdate <  cast('1995-03-22' as timestamp)
        and l_shipdate > cast('1995-03-22' as timestamp)
group by
        l_orderkey,
        o_orderdate,
        o_shippriority
order by
        revenue desc,
        o_orderdate
limit 10,,)
Time :6.896 ] 

 
4.01 [ Query :Query(select
        o_orderpriority,
        count(*) as order_count
from
        orders as o
where
        o_orderdate >= cast('1996-05-01' as timestamp)
        and o_orderdate < cast('1996-08-01' as timestamp)
        and exists (
                select
                        *
                from
                        lineitem
                where
                        l_orderkey = o.o_orderkey
                        and l_commitdate < l_receiptdate
        )
group by
        o_orderpriority
order by
        o_orderpriority,,)
Time :4.01 ] 

 
5.348 [ Query :Query(select
        n_name,
        sum(l_extendedprice * (1 - l_discount)) as revenue
from
        customer,
        orders,
        lineitem,
        supplier,
        nation,
        region
where
        c_custkey = o_custkey
        and l_orderkey = o_orderkey
        and l_suppkey = s_suppkey
        and c_nationkey = s_nationkey
        and s_nationkey = n_nationkey
        and n_regionkey = r_regionkey
        and r_name = 'AFRICA'
        and o_orderdate >= cast('1993-01-01' as timestamp)
        and o_orderdate < cast('1994-01-01' as timestamp)
group by
        n_name
order by
        revenue desc,,)
Time :5.348 ] 

 
3.521 [ Query :Query(select
        o_orderpriority,
        count(*) as order_count
from
        orders as o
where
        o_orderdate >= cast('1996-05-01' as timestamp)
        and o_orderdate < cast('1996-08-01' as timestamp)
        and exists (
                select
                        *
                from
                        lineitem
                where
                        l_orderkey = o.o_orderkey
                        and l_commitdate < l_receiptdate
        )
group by
        o_orderpriority
order by
        o_orderpriority,,)
Time :3.521 ] 

 
4.852 [ Query :Query(select
        n_name,
        sum(l_extendedprice * (1 - l_discount)) as revenue
from
        customer,
        orders,
        lineitem,
        supplier,
        nation,
        region
where
        c_custkey = o_custkey
        and l_orderkey = o_orderkey
        and l_suppkey = s_suppkey
        and c_nationkey = s_nationkey
        and s_nationkey = n_nationkey
        and n_regionkey = r_regionkey
        and r_name = 'AFRICA'
        and o_orderdate >= cast('1993-01-01' as timestamp)
        and o_orderdate < cast('1994-01-01' as timestamp) 
group by
        n_name
order by
        revenue desc,,)
Time :4.852 ] 

 
0.568 [ Query :Query(select
        sum(l_extendedprice * l_discount) as revenue
from
        lineitem
where
        l_shipdate >= cast('1993-01-01' as timestamp)
        and l_shipdate < cast('1994-01-01' as timestamp) 
        and l_discount between 0.06 - 0.01 and 0.06 + 0.01
        and l_quantity < 25,,)
Time :0.568 ] 

 
4.88 [ Query :Query(select
        supp_nation,
        cust_nation,
        l_year,
        sum(volume) as revenue
from
        (
                select
                        n1.n_name as supp_nation,
                        n2.n_name as cust_nation,
                        year(l_shipdate) as l_year,
                        l_extendedprice * (1 - l_discount) as volume
                from
                        supplier,
                        lineitem,
                        orders,
                        customer,
                        nation n1,
                        nation n2
                where
                        s_suppkey = l_suppkey
                        and o_orderkey = l_orderkey
                        and c_custkey = o_custkey
                        and s_nationkey = n1.n_nationkey
                        and c_nationkey = n2.n_nationkey
                        and (
                                (n1.n_name = 'KENYA' and n2.n_name = 'PERU')
                                or (n1.n_name = 'PERU' and n2.n_name = 'KENYA')
                        )
                        and l_shipdate between cast('1995-01-01' as timestamp) and cast('1996-12-31' as timestamp)
        ) as shipping
group by
        supp_nation,
        cust_nation,
        l_year
order by
        supp_nation,
        cust_nation,
        l_year,,)
Time :4.88 ] 

 
18.918 [ Query :Query(select
        o_year,
        sum(case
                when nation = 'PERU' then volume
                else 0
        end) / sum(volume) as mkt_share
from
        (
                select
                        year(o_orderdate) as o_year,
                        l_extendedprice * (1 - l_discount) as volume,
                        n2.n_name as nation
                from
                        part,
                        supplier,
                        lineitem,
                        orders,
                        customer,
                        nation n1,
                        nation n2,
                        region
                where
                        p_partkey = l_partkey
                        and s_suppkey = l_suppkey
                        and l_orderkey = o_orderkey
                        and o_custkey = c_custkey
                        and c_nationkey = n1.n_nationkey
                        and n1.n_regionkey = r_regionkey
                        and r_name = 'AMERICA'
                        and s_nationkey = n2.n_nationkey
                        and o_orderdate between cast('1995-01-01' as timestamp) and  cast('1996-12-31' as timestamp)
                        and p_type = 'ECONOMY BURNISHED NICKEL'
        ) as all_nations
group by
        o_year
order by
        o_year,,)
Time :18.918 ] 

 
4.887 [ Query :Query(select
        c_custkey,
        c_name,
        sum(l_extendedprice * (1 - l_discount)) as revenue,
        c_acctbal,
        n_name,
        c_address,
        c_phone,
        c_comment
from
        customer,
        orders,
        lineitem,
        nation
where
        c_custkey = o_custkey
        and l_orderkey = o_orderkey
        and o_orderdate >= cast('1993-07-01' as timestamp)
        and o_orderdate < cast('1993-10-01' as timestamp)
        and l_returnflag = 'R'
        and c_nationkey = n_nationkey
group by
        c_custkey,
        c_name,
        c_acctbal,
        c_phone,
        n_name,
        c_address,
        c_comment
order by
        revenue desc
limit 20,,)
Time :4.887 ] 

 
3.28 [ Query :Query(select
        l_shipmode,
        sum(case
                when o_orderpriority = '1-URGENT'
                        or o_orderpriority = '2-HIGH'
                        then 1
                else 0
        end) as high_line_count,
        sum(case
                when o_orderpriority <> '1-URGENT'
                        and o_orderpriority <> '2-HIGH'
                        then 1
                else 0
        end) as low_line_count
from
        orders,
        lineitem
where
        o_orderkey = l_orderkey
        and l_shipmode in ('REG AIR', 'MAIL')
        and l_commitdate < l_receiptdate
        and l_shipdate < l_commitdate
        and l_receiptdate >= cast('1995-01-01' as timestamp) 
        and l_receiptdate < cast('1996-01-01' as timestamp) 
group by
        l_shipmode
order by
        l_shipmode,,)
Time :3.28 ] 

 
7.509 [ Query :Query(select
        c_count,
        count(*) as custdist
from
        (
                select
                        c_custkey,
                        count(o_orderkey) as c_count
                from
                        customer left outer join orders on
                                c_custkey = o_custkey
                                and o_comment not like '%unusual%accounts%'
                group by
                        c_custkey
        ) c_orders
group by
        c_count
order by
        custdist desc,
        c_count desc,,)
Time :7.509 ] 

 
0.931 [ Query :Query(select
        100.00 * sum(case
                when p_type like 'PROMO%'
                        then l_extendedprice * (1 - l_discount)
                else 0
        end) / sum(l_extendedprice * (1 - l_discount)) as promo_revenue
from
        lineitem,
        part
where
        l_partkey = p_partkey
        and l_shipdate >= cast('1995-08-01' as timestamp) 
        and l_shipdate < cast('1995-09-01' as timestamp),,)
Time :0.931 ] 

 
3.257 [ Query :Query(select
        p_brand,
        p_type,
        p_size,
        count(distinct ps_suppkey) as supplier_cnt
from
        partsupp,
        part
where
        p_partkey = ps_partkey
        and p_brand <> 'Brand#34'
        and p_type not like 'ECONOMY BRUSHED%'
        and p_size in (22, 14, 27, 49, 21, 33, 35, 28)
        and partsupp.ps_suppkey not in (
                select
                        s_suppkey
                from
                        supplier
                where
                        s_comment like '%Customer%Complaints%'
        )
group by
        p_brand,
        p_type,
        p_size
order by
        supplier_cnt desc,
        p_brand,
        p_type,
        p_size,,)
Time :3.257 ] 

 
0.639 [ Query :Query(with q17_part as (
  select p_partkey from part where  
  p_brand = 'Brand#23'
  and p_container = 'MED BOX'
),
q17_avg as (
  select l_partkey as t_partkey, 0.2 * avg(l_quantity) as t_avg_quantity
  from lineitem 
  where l_partkey IN (select p_partkey from q17_part)
  group by l_partkey
),
q17_price as (
  select
  l_quantity,
  l_partkey,
  l_extendedprice
  from
  lineitem
  where
  l_partkey IN (select p_partkey from q17_part)
)
select cast(sum(l_extendedprice) / 7.0 as decimal(32,2)) as avg_yearly
from q17_avg, q17_price
where 
t_partkey = l_partkey and l_quantity < t_avg_quantity,,)
Time :0.639 ] 

 
2.453 [ Query :Query(-- explain formatted 
with tmp1 as (
    select p_partkey from part where p_name like 'forest%'
),
tmp2 as (
    select s_name, s_address, s_suppkey
    from supplier, nation
    where s_nationkey = n_nationkey
    and n_name = 'CANADA'
),
tmp3 as (
    select l_partkey, 0.5 * sum(l_quantity) as sum_quantity, l_suppkey
    from lineitem, tmp2
    where l_shipdate >= cast('1994-01-01' as timestamp) and l_shipdate <= cast('1995-01-01' as timestamp)
    and l_suppkey = s_suppkey 
    group by l_partkey, l_suppkey
),
tmp4 as (
    select ps_partkey, ps_suppkey, ps_availqty
    from partsupp 
    where ps_partkey IN (select p_partkey from tmp1)
),
tmp5 as (
select
    ps_suppkey
from
    tmp4, tmp3
where
    ps_partkey = l_partkey
    and ps_suppkey = l_suppkey
    and ps_availqty > sum_quantity
)
select
    s_name,
    s_address
from
    supplier
where
    s_suppkey IN (select ps_suppkey from tmp5)
order by s_name,,)
Time :2.453 ] 

 
5.009 [ Query :Query(select
        l_returnflag,
        l_linestatus,
        sum(l_quantity) as sum_qty,
        sum(l_extendedprice) as sum_base_price,
        sum(l_extendedprice * (1 - l_discount)) as sum_disc_price,
        sum(l_extendedprice * (1 - l_discount) * (1 + l_tax)) as sum_charge,
        avg(l_quantity) as avg_qty,
        avg(l_extendedprice) as avg_price,
        avg(l_discount) as avg_disc,
        count(*) as count_order
from
        lineitem
where
        l_shipdate <= cast('1998-09-16' as timestamp)
group by
        l_returnflag,
        l_linestatus
order by
        l_returnflag,
        l_linestatus,,)
Time :5.009 ] 

 
9.077 [ Query :Query(select
        l_returnflag,
        l_linestatus,
        sum(l_quantity) as sum_qty,
        sum(l_extendedprice) as sum_base_price,
        sum(l_extendedprice * (1 - l_discount)) as sum_disc_price,
        sum(l_extendedprice * (1 - l_discount) * (1 + l_tax)) as sum_charge,
        avg(l_quantity) as avg_qty,
        avg(l_extendedprice) as avg_price,
        avg(l_discount) as avg_disc,
        count(*) as count_order
from
        lineitem
where
        l_shipdate <= cast('1998-09-16' as timestamp)
group by
        l_returnflag,
        l_linestatus
order by
        l_returnflag,
        l_linestatus,,)
Time :9.077 ] 

 
243.831 [ Query :Query(select
        l_returnflag,
        l_linestatus,
        sum(l_quantity) as sum_qty,
        sum(l_extendedprice) as sum_base_price,
        sum(l_extendedprice * (1 - l_discount)) as sum_disc_price,
        sum(l_extendedprice * (1 - l_discount) * (1 + l_tax)) as sum_charge,
        avg(l_quantity) as avg_qty,
        avg(l_extendedprice) as avg_price,
        avg(l_discount) as avg_disc,
        count(*) as count_order
from
        lineitem
where
        l_shipdate <= cast('1998-09-16' as timestamp)
group by
        l_returnflag,
        l_linestatus
order by
        l_returnflag,
        l_linestatus,,)
Time :243.831 ] 

 
8.268 [ Query :Query(select
        l_returnflag,
        l_linestatus,
        sum(l_quantity) as sum_qty,
        sum(l_extendedprice) as sum_base_price,
        sum(l_extendedprice * (1 - l_discount)) as sum_disc_price,
        sum(l_extendedprice * (1 - l_discount) * (1 + l_tax)) as sum_charge,
        avg(l_quantity) as avg_qty,
        avg(l_extendedprice) as avg_price,
        avg(l_discount) as avg_disc,
        count(*) as count_order
from
        lineitem
where
        l_shipdate <= cast('1998-09-16' as timestamp)
group by
        l_returnflag,
        l_linestatus
order by
        l_returnflag,
        l_linestatus,,)
Time :8.268 ] 

 
8.175 [ Query :Query(select
        l_orderkey,
        sum(l_extendedprice * (1 - l_discount)) as revenue,
        o_orderdate,
        o_shippriority
from
        customer,
        orders,
        lineitem
where
        c_mktsegment = 'BUILDING'
        and c_custkey = o_custkey
        and l_orderkey = o_orderkey
        and o_orderdate <  cast('1995-03-22' as timestamp)
        and l_shipdate > cast('1995-03-22' as timestamp)
group by
        l_orderkey,
        o_orderdate,
        o_shippriority
order by
        revenue desc,
        o_orderdate
limit 10,,)
Time :8.175 ] 

 
4.543 [ Query :Query(select
        o_orderpriority,
        count(*) as order_count
from
        orders as o
where
        o_orderdate >= cast('1996-05-01' as timestamp)
        and o_orderdate < cast('1996-08-01' as timestamp)
        and exists (
                select
                        *
                from
                        lineitem
                where
                        l_orderkey = o.o_orderkey
                        and l_commitdate < l_receiptdate
        )
group by
        o_orderpriority
order by
        o_orderpriority,,)
Time :4.543 ] 

 
6.279 [ Query :Query(select
        n_name,
        sum(l_extendedprice * (1 - l_discount)) as revenue
from
        customer,
        orders,
        lineitem,
        supplier,
        nation,
        region
where
        c_custkey = o_custkey
        and l_orderkey = o_orderkey
        and l_suppkey = s_suppkey
        and c_nationkey = s_nationkey
        and s_nationkey = n_nationkey
        and n_regionkey = r_regionkey
        and r_name = 'AFRICA'
        and o_orderdate >= cast('1993-01-01' as timestamp)
        and o_orderdate < cast('1994-01-01' as timestamp)
group by
        n_name
order by
        revenue desc,,)
Time :6.279 ] 

 
3.46 [ Query :Query(select
        o_orderpriority,
        count(*) as order_count
from
        orders as o
where
        o_orderdate >= cast('1996-05-01' as timestamp)
        and o_orderdate < cast('1996-08-01' as timestamp)
        and exists (
                select
                        *
                from
                        lineitem
                where
                        l_orderkey = o.o_orderkey
                        and l_commitdate < l_receiptdate
        )
group by
        o_orderpriority
order by
        o_orderpriority,,)
Time :3.46 ] 

 
5.206 [ Query :Query(select
        n_name,
        sum(l_extendedprice * (1 - l_discount)) as revenue
from
        customer,
        orders,
        lineitem,
        supplier,
        nation,
        region
where
        c_custkey = o_custkey
        and l_orderkey = o_orderkey
        and l_suppkey = s_suppkey
        and c_nationkey = s_nationkey
        and s_nationkey = n_nationkey
        and n_regionkey = r_regionkey
        and r_name = 'AFRICA'
        and o_orderdate >= cast('1993-01-01' as timestamp)
        and o_orderdate < cast('1994-01-01' as timestamp) 
group by
        n_name
order by
        revenue desc,,)
Time :5.206 ] 

 
0.435 [ Query :Query(select
        sum(l_extendedprice * l_discount) as revenue
from
        lineitem
where
        l_shipdate >= cast('1993-01-01' as timestamp)
        and l_shipdate < cast('1994-01-01' as timestamp) 
        and l_discount between 0.06 - 0.01 and 0.06 + 0.01
        and l_quantity < 25,,)
Time :0.435 ] 

 
4.885 [ Query :Query(select
        supp_nation,
        cust_nation,
        l_year,
        sum(volume) as revenue
from
        (
                select
                        n1.n_name as supp_nation,
                        n2.n_name as cust_nation,
                        year(l_shipdate) as l_year,
                        l_extendedprice * (1 - l_discount) as volume
                from
                        supplier,
                        lineitem,
                        orders,
                        customer,
                        nation n1,
                        nation n2
                where
                        s_suppkey = l_suppkey
                        and o_orderkey = l_orderkey
                        and c_custkey = o_custkey
                        and s_nationkey = n1.n_nationkey
                        and c_nationkey = n2.n_nationkey
                        and (
                                (n1.n_name = 'KENYA' and n2.n_name = 'PERU')
                                or (n1.n_name = 'PERU' and n2.n_name = 'KENYA')
                        )
                        and l_shipdate between cast('1995-01-01' as timestamp) and cast('1996-12-31' as timestamp)
        ) as shipping
group by
        supp_nation,
        cust_nation,
        l_year
order by
        supp_nation,
        cust_nation,
        l_year,,)
Time :4.885 ] 

 
19.506 [ Query :Query(select
        o_year,
        sum(case
                when nation = 'PERU' then volume
                else 0
        end) / sum(volume) as mkt_share
from
        (
                select
                        year(o_orderdate) as o_year,
                        l_extendedprice * (1 - l_discount) as volume,
                        n2.n_name as nation
                from
                        part,
                        supplier,
                        lineitem,
                        orders,
                        customer,
                        nation n1,
                        nation n2,
                        region
                where
                        p_partkey = l_partkey
                        and s_suppkey = l_suppkey
                        and l_orderkey = o_orderkey
                        and o_custkey = c_custkey
                        and c_nationkey = n1.n_nationkey
                        and n1.n_regionkey = r_regionkey
                        and r_name = 'AMERICA'
                        and s_nationkey = n2.n_nationkey
                        and o_orderdate between cast('1995-01-01' as timestamp) and  cast('1996-12-31' as timestamp)
                        and p_type = 'ECONOMY BURNISHED NICKEL'
        ) as all_nations
group by
        o_year
order by
        o_year,,)
Time :19.506 ] 

 
5.344 [ Query :Query(select
        c_custkey,
        c_name,
        sum(l_extendedprice * (1 - l_discount)) as revenue,
        c_acctbal,
        n_name,
        c_address,
        c_phone,
        c_comment
from
        customer,
        orders,
        lineitem,
        nation
where
        c_custkey = o_custkey
        and l_orderkey = o_orderkey
        and o_orderdate >= cast('1993-07-01' as timestamp)
        and o_orderdate < cast('1993-10-01' as timestamp)
        and l_returnflag = 'R'
        and c_nationkey = n_nationkey
group by
        c_custkey,
        c_name,
        c_acctbal,
        c_phone,
        n_name,
        c_address,
        c_comment
order by
        revenue desc
limit 20,,)
Time :5.344 ] 

 
3.585 [ Query :Query(select
        l_shipmode,
        sum(case
                when o_orderpriority = '1-URGENT'
                        or o_orderpriority = '2-HIGH'
                        then 1
                else 0
        end) as high_line_count,
        sum(case
                when o_orderpriority <> '1-URGENT'
                        and o_orderpriority <> '2-HIGH'
                        then 1
                else 0
        end) as low_line_count
from
        orders,
        lineitem
where
        o_orderkey = l_orderkey
        and l_shipmode in ('REG AIR', 'MAIL')
        and l_commitdate < l_receiptdate
        and l_shipdate < l_commitdate
        and l_receiptdate >= cast('1995-01-01' as timestamp) 
        and l_receiptdate < cast('1996-01-01' as timestamp) 
group by
        l_shipmode
order by
        l_shipmode,,)
Time :3.585 ] 

 
8.59 [ Query :Query(select
        c_count,
        count(*) as custdist
from
        (
                select
                        c_custkey,
                        count(o_orderkey) as c_count
                from
                        customer left outer join orders on
                                c_custkey = o_custkey
                                and o_comment not like '%unusual%accounts%'
                group by
                        c_custkey
        ) c_orders
group by
        c_count
order by
        custdist desc,
        c_count desc,,)
Time :8.59 ] 

 
1.024 [ Query :Query(select
        100.00 * sum(case
                when p_type like 'PROMO%'
                        then l_extendedprice * (1 - l_discount)
                else 0
        end) / sum(l_extendedprice * (1 - l_discount)) as promo_revenue
from
        lineitem,
        part
where
        l_partkey = p_partkey
        and l_shipdate >= cast('1995-08-01' as timestamp) 
        and l_shipdate < cast('1995-09-01' as timestamp),,)
Time :1.024 ] 

 
4.023 [ Query :Query(select
        p_brand,
        p_type,
        p_size,
        count(distinct ps_suppkey) as supplier_cnt
from
        partsupp,
        part
where
        p_partkey = ps_partkey
        and p_brand <> 'Brand#34'
        and p_type not like 'ECONOMY BRUSHED%'
        and p_size in (22, 14, 27, 49, 21, 33, 35, 28)
        and partsupp.ps_suppkey not in (
                select
                        s_suppkey
                from
                        supplier
                where
                        s_comment like '%Customer%Complaints%'
        )
group by
        p_brand,
        p_type,
        p_size
order by
        supplier_cnt desc,
        p_brand,
        p_type,
        p_size,,)
Time :4.023 ] 

 
0.767 [ Query :Query(with q17_part as (
  select p_partkey from part where  
  p_brand = 'Brand#23'
  and p_container = 'MED BOX'
),
q17_avg as (
  select l_partkey as t_partkey, 0.2 * avg(l_quantity) as t_avg_quantity
  from lineitem 
  where l_partkey IN (select p_partkey from q17_part)
  group by l_partkey
),
q17_price as (
  select
  l_quantity,
  l_partkey,
  l_extendedprice
  from
  lineitem
  where
  l_partkey IN (select p_partkey from q17_part)
)
select cast(sum(l_extendedprice) / 7.0 as decimal(32,2)) as avg_yearly
from q17_avg, q17_price
where 
t_partkey = l_partkey and l_quantity < t_avg_quantity,,)
Time :0.767 ] 

 
2.829 [ Query :Query(-- explain formatted 
with tmp1 as (
    select p_partkey from part where p_name like 'forest%'
),
tmp2 as (
    select s_name, s_address, s_suppkey
    from supplier, nation
    where s_nationkey = n_nationkey
    and n_name = 'CANADA'
),
tmp3 as (
    select l_partkey, 0.5 * sum(l_quantity) as sum_quantity, l_suppkey
    from lineitem, tmp2
    where l_shipdate >= cast('1994-01-01' as timestamp) and l_shipdate <= cast('1995-01-01' as timestamp)
    and l_suppkey = s_suppkey 
    group by l_partkey, l_suppkey
),
tmp4 as (
    select ps_partkey, ps_suppkey, ps_availqty
    from partsupp 
    where ps_partkey IN (select p_partkey from tmp1)
),
tmp5 as (
select
    ps_suppkey
from
    tmp4, tmp3
where
    ps_partkey = l_partkey
    and ps_suppkey = l_suppkey
    and ps_availqty > sum_quantity
)
select
    s_name,
    s_address
from
    supplier
where
    s_suppkey IN (select ps_suppkey from tmp5)
order by s_name,,)
Time :2.829 ] 

 
4.698 [ Query :Query(select
        l_returnflag,
        l_linestatus,
        sum(l_quantity) as sum_qty,
        sum(l_extendedprice) as sum_base_price,
        sum(l_extendedprice * (1 - l_discount)) as sum_disc_price,
        sum(l_extendedprice * (1 - l_discount) * (1 + l_tax)) as sum_charge,
        avg(l_quantity) as avg_qty,
        avg(l_extendedprice) as avg_price,
        avg(l_discount) as avg_disc,
        count(*) as count_order
from
        lineitem
where
        l_shipdate <= cast('1998-09-16' as timestamp)
group by
        l_returnflag,
        l_linestatus
order by
        l_returnflag,
        l_linestatus,,)
Time :4.698 ] 

 
9.224 [ Query :Query(select
        l_orderkey,
        sum(l_extendedprice * (1 - l_discount)) as revenue,
        o_orderdate,
        o_shippriority
from
        customer,
        orders,
        lineitem
where
        c_mktsegment = 'BUILDING'
        and c_custkey = o_custkey
        and l_orderkey = o_orderkey
        and o_orderdate <  cast('1995-03-22' as timestamp)
        and l_shipdate > cast('1995-03-22' as timestamp)
group by
        l_orderkey,
        o_orderdate,
        o_shippriority
order by
        revenue desc,
        o_orderdate
limit 10,,)
Time :9.224 ] 

 
4.947 [ Query :Query(select
        o_orderpriority,
        count(*) as order_count
from
        orders as o
where
        o_orderdate >= cast('1996-05-01' as timestamp)
        and o_orderdate < cast('1996-08-01' as timestamp)
        and exists (
                select
                        *
                from
                        lineitem
                where
                        l_orderkey = o.o_orderkey
                        and l_commitdate < l_receiptdate
        )
group by
        o_orderpriority
order by
        o_orderpriority,,)
Time :4.947 ] 

 
5.866 [ Query :Query(select
        n_name,
        sum(l_extendedprice * (1 - l_discount)) as revenue
from
        customer,
        orders,
        lineitem,
        supplier,
        nation,
        region
where
        c_custkey = o_custkey
        and l_orderkey = o_orderkey
        and l_suppkey = s_suppkey
        and c_nationkey = s_nationkey
        and s_nationkey = n_nationkey
        and n_regionkey = r_regionkey
        and r_name = 'AFRICA'
        and o_orderdate >= cast('1993-01-01' as timestamp)
        and o_orderdate < cast('1994-01-01' as timestamp)
group by
        n_name
order by
        revenue desc,,)
Time :5.866 ] 

 
3.504 [ Query :Query(select
        o_orderpriority,
        count(*) as order_count
from
        orders as o
where
        o_orderdate >= cast('1996-05-01' as timestamp)
        and o_orderdate < cast('1996-08-01' as timestamp)
        and exists (
                select
                        *
                from
                        lineitem
                where
                        l_orderkey = o.o_orderkey
                        and l_commitdate < l_receiptdate
        )
group by
        o_orderpriority
order by
        o_orderpriority,,)
Time :3.504 ] 

 
4.673 [ Query :Query(select
        n_name,
        sum(l_extendedprice * (1 - l_discount)) as revenue
from
        customer,
        orders,
        lineitem,
        supplier,
        nation,
        region
where
        c_custkey = o_custkey
        and l_orderkey = o_orderkey
        and l_suppkey = s_suppkey
        and c_nationkey = s_nationkey
        and s_nationkey = n_nationkey
        and n_regionkey = r_regionkey
        and r_name = 'AFRICA'
        and o_orderdate >= cast('1993-01-01' as timestamp)
        and o_orderdate < cast('1994-01-01' as timestamp) 
group by
        n_name
order by
        revenue desc,,)
Time :4.673 ] 

 
0.382 [ Query :Query(select
        sum(l_extendedprice * l_discount) as revenue
from
        lineitem
where
        l_shipdate >= cast('1993-01-01' as timestamp)
        and l_shipdate < cast('1994-01-01' as timestamp) 
        and l_discount between 0.06 - 0.01 and 0.06 + 0.01
        and l_quantity < 25,,)
Time :0.382 ] 

 
4.513 [ Query :Query(select
        supp_nation,
        cust_nation,
        l_year,
        sum(volume) as revenue
from
        (
                select
                        n1.n_name as supp_nation,
                        n2.n_name as cust_nation,
                        year(l_shipdate) as l_year,
                        l_extendedprice * (1 - l_discount) as volume
                from
                        supplier,
                        lineitem,
                        orders,
                        customer,
                        nation n1,
                        nation n2
                where
                        s_suppkey = l_suppkey
                        and o_orderkey = l_orderkey
                        and c_custkey = o_custkey
                        and s_nationkey = n1.n_nationkey
                        and c_nationkey = n2.n_nationkey
                        and (
                                (n1.n_name = 'KENYA' and n2.n_name = 'PERU')
                                or (n1.n_name = 'PERU' and n2.n_name = 'KENYA')
                        )
                        and l_shipdate between cast('1995-01-01' as timestamp) and cast('1996-12-31' as timestamp)
        ) as shipping
group by
        supp_nation,
        cust_nation,
        l_year
order by
        supp_nation,
        cust_nation,
        l_year,,)
Time :4.513 ] 

 
20.223 [ Query :Query(select
        o_year,
        sum(case
                when nation = 'PERU' then volume
                else 0
        end) / sum(volume) as mkt_share
from
        (
                select
                        year(o_orderdate) as o_year,
                        l_extendedprice * (1 - l_discount) as volume,
                        n2.n_name as nation
                from
                        part,
                        supplier,
                        lineitem,
                        orders,
                        customer,
                        nation n1,
                        nation n2,
                        region
                where
                        p_partkey = l_partkey
                        and s_suppkey = l_suppkey
                        and l_orderkey = o_orderkey
                        and o_custkey = c_custkey
                        and c_nationkey = n1.n_nationkey
                        and n1.n_regionkey = r_regionkey
                        and r_name = 'AMERICA'
                        and s_nationkey = n2.n_nationkey
                        and o_orderdate between cast('1995-01-01' as timestamp) and  cast('1996-12-31' as timestamp)
                        and p_type = 'ECONOMY BURNISHED NICKEL'
        ) as all_nations
group by
        o_year
order by
        o_year,,)
Time :20.223 ] 

 
5.737 [ Query :Query(select
        c_custkey,
        c_name,
        sum(l_extendedprice * (1 - l_discount)) as revenue,
        c_acctbal,
        n_name,
        c_address,
        c_phone,
        c_comment
from
        customer,
        orders,
        lineitem,
        nation
where
        c_custkey = o_custkey
        and l_orderkey = o_orderkey
        and o_orderdate >= cast('1993-07-01' as timestamp)
        and o_orderdate < cast('1993-10-01' as timestamp)
        and l_returnflag = 'R'
        and c_nationkey = n_nationkey
group by
        c_custkey,
        c_name,
        c_acctbal,
        c_phone,
        n_name,
        c_address,
        c_comment
order by
        revenue desc
limit 20,,)
Time :5.737 ] 

 
3.337 [ Query :Query(select
        l_shipmode,
        sum(case
                when o_orderpriority = '1-URGENT'
                        or o_orderpriority = '2-HIGH'
                        then 1
                else 0
        end) as high_line_count,
        sum(case
                when o_orderpriority <> '1-URGENT'
                        and o_orderpriority <> '2-HIGH'
                        then 1
                else 0
        end) as low_line_count
from
        orders,
        lineitem
where
        o_orderkey = l_orderkey
        and l_shipmode in ('REG AIR', 'MAIL')
        and l_commitdate < l_receiptdate
        and l_shipdate < l_commitdate
        and l_receiptdate >= cast('1995-01-01' as timestamp) 
        and l_receiptdate < cast('1996-01-01' as timestamp) 
group by
        l_shipmode
order by
        l_shipmode,,)
Time :3.337 ] 

 
9.224 [ Query :Query(select
        c_count,
        count(*) as custdist
from
        (
                select
                        c_custkey,
                        count(o_orderkey) as c_count
                from
                        customer left outer join orders on
                                c_custkey = o_custkey
                                and o_comment not like '%unusual%accounts%'
                group by
                        c_custkey
        ) c_orders
group by
        c_count
order by
        custdist desc,
        c_count desc,,)
Time :9.224 ] 

 
1.28 [ Query :Query(select
        100.00 * sum(case
                when p_type like 'PROMO%'
                        then l_extendedprice * (1 - l_discount)
                else 0
        end) / sum(l_extendedprice * (1 - l_discount)) as promo_revenue
from
        lineitem,
        part
where
        l_partkey = p_partkey
        and l_shipdate >= cast('1995-08-01' as timestamp) 
        and l_shipdate < cast('1995-09-01' as timestamp),,)
Time :1.28 ] 

 
4.523 [ Query :Query(select
        p_brand,
        p_type,
        p_size,
        count(distinct ps_suppkey) as supplier_cnt
from
        partsupp,
        part
where
        p_partkey = ps_partkey
        and p_brand <> 'Brand#34'
        and p_type not like 'ECONOMY BRUSHED%'
        and p_size in (22, 14, 27, 49, 21, 33, 35, 28)
        and partsupp.ps_suppkey not in (
                select
                        s_suppkey
                from
                        supplier
                where
                        s_comment like '%Customer%Complaints%'
        )
group by
        p_brand,
        p_type,
        p_size
order by
        supplier_cnt desc,
        p_brand,
        p_type,
        p_size,,)
Time :4.523 ] 

 
0.839 [ Query :Query(with q17_part as (
  select p_partkey from part where  
  p_brand = 'Brand#23'
  and p_container = 'MED BOX'
),
q17_avg as (
  select l_partkey as t_partkey, 0.2 * avg(l_quantity) as t_avg_quantity
  from lineitem 
  where l_partkey IN (select p_partkey from q17_part)
  group by l_partkey
),
q17_price as (
  select
  l_quantity,
  l_partkey,
  l_extendedprice
  from
  lineitem
  where
  l_partkey IN (select p_partkey from q17_part)
)
select cast(sum(l_extendedprice) / 7.0 as decimal(32,2)) as avg_yearly
from q17_avg, q17_price
where 
t_partkey = l_partkey and l_quantity < t_avg_quantity,,)
Time :0.839 ] 

 
3.625 [ Query :Query(-- explain formatted 
with tmp1 as (
    select p_partkey from part where p_name like 'forest%'
),
tmp2 as (
    select s_name, s_address, s_suppkey
    from supplier, nation
    where s_nationkey = n_nationkey
    and n_name = 'CANADA'
),
tmp3 as (
    select l_partkey, 0.5 * sum(l_quantity) as sum_quantity, l_suppkey
    from lineitem, tmp2
    where l_shipdate >= cast('1994-01-01' as timestamp) and l_shipdate <= cast('1995-01-01' as timestamp)
    and l_suppkey = s_suppkey 
    group by l_partkey, l_suppkey
),
tmp4 as (
    select ps_partkey, ps_suppkey, ps_availqty
    from partsupp 
    where ps_partkey IN (select p_partkey from tmp1)
),
tmp5 as (
select
    ps_suppkey
from
    tmp4, tmp3
where
    ps_partkey = l_partkey
    and ps_suppkey = l_suppkey
    and ps_availqty > sum_quantity
)
select
    s_name,
    s_address
from
    supplier
where
    s_suppkey IN (select ps_suppkey from tmp5)
order by s_name,,)
Time :3.625 ] 

 
6.744 [ Query :Query(select
        l_returnflag,
        l_linestatus,
        sum(l_quantity) as sum_qty,
        sum(l_extendedprice) as sum_base_price,
        sum(l_extendedprice * (1 - l_discount)) as sum_disc_price,
        sum(l_extendedprice * (1 - l_discount) * (1 + l_tax)) as sum_charge,
        avg(l_quantity) as avg_qty,
        avg(l_extendedprice) as avg_price,
        avg(l_discount) as avg_disc,
        count(*) as count_order
from
        lineitem
where
        l_shipdate <= cast('1998-09-16' as timestamp)
group by
        l_returnflag,
        l_linestatus
order by
        l_returnflag,
        l_linestatus,,)
Time :6.744 ] 

 
8.916 [ Query :Query(select
        l_orderkey,
        sum(l_extendedprice * (1 - l_discount)) as revenue,
        o_orderdate,
        o_shippriority
from
        customer,
        orders,
        lineitem
where
        c_mktsegment = 'BUILDING'
        and c_custkey = o_custkey
        and l_orderkey = o_orderkey
        and o_orderdate <  cast('1995-03-22' as timestamp)
        and l_shipdate > cast('1995-03-22' as timestamp)
group by
        l_orderkey,
        o_orderdate,
        o_shippriority
order by
        revenue desc,
        o_orderdate
limit 10,,)
Time :8.916 ] 

 
5.346 [ Query :Query(select
        o_orderpriority,
        count(*) as order_count
from
        orders as o
where
        o_orderdate >= cast('1996-05-01' as timestamp)
        and o_orderdate < cast('1996-08-01' as timestamp)
        and exists (
                select
                        *
                from
                        lineitem
                where
                        l_orderkey = o.o_orderkey
                        and l_commitdate < l_receiptdate
        )
group by
        o_orderpriority
order by
        o_orderpriority,,)
Time :5.346 ] 

 
5.399 [ Query :Query(select
        n_name,
        sum(l_extendedprice * (1 - l_discount)) as revenue
from
        customer,
        orders,
        lineitem,
        supplier,
        nation,
        region
where
        c_custkey = o_custkey
        and l_orderkey = o_orderkey
        and l_suppkey = s_suppkey
        and c_nationkey = s_nationkey
        and s_nationkey = n_nationkey
        and n_regionkey = r_regionkey
        and r_name = 'AFRICA'
        and o_orderdate >= cast('1993-01-01' as timestamp)
        and o_orderdate < cast('1994-01-01' as timestamp)
group by
        n_name
order by
        revenue desc,,)
Time :5.399 ] 

 
4.221 [ Query :Query(select
        o_orderpriority,
        count(*) as order_count
from
        orders as o
where
        o_orderdate >= cast('1996-05-01' as timestamp)
        and o_orderdate < cast('1996-08-01' as timestamp)
        and exists (
                select
                        *
                from
                        lineitem
                where
                        l_orderkey = o.o_orderkey
                        and l_commitdate < l_receiptdate
        )
group by
        o_orderpriority
order by
        o_orderpriority,,)
Time :4.221 ] 

 
5.425 [ Query :Query(select
        n_name,
        sum(l_extendedprice * (1 - l_discount)) as revenue
from
        customer,
        orders,
        lineitem,
        supplier,
        nation,
        region
where
        c_custkey = o_custkey
        and l_orderkey = o_orderkey
        and l_suppkey = s_suppkey
        and c_nationkey = s_nationkey
        and s_nationkey = n_nationkey
        and n_regionkey = r_regionkey
        and r_name = 'AFRICA'
        and o_orderdate >= cast('1993-01-01' as timestamp)
        and o_orderdate < cast('1994-01-01' as timestamp) 
group by
        n_name
order by
        revenue desc,,)
Time :5.425 ] 

 
0.311 [ Query :Query(select
        sum(l_extendedprice * l_discount) as revenue
from
        lineitem
where
        l_shipdate >= cast('1993-01-01' as timestamp)
        and l_shipdate < cast('1994-01-01' as timestamp) 
        and l_discount between 0.06 - 0.01 and 0.06 + 0.01
        and l_quantity < 25,,)
Time :0.311 ] 

 
4.929 [ Query :Query(select
        supp_nation,
        cust_nation,
        l_year,
        sum(volume) as revenue
from
        (
                select
                        n1.n_name as supp_nation,
                        n2.n_name as cust_nation,
                        year(l_shipdate) as l_year,
                        l_extendedprice * (1 - l_discount) as volume
                from
                        supplier,
                        lineitem,
                        orders,
                        customer,
                        nation n1,
                        nation n2
                where
                        s_suppkey = l_suppkey
                        and o_orderkey = l_orderkey
                        and c_custkey = o_custkey
                        and s_nationkey = n1.n_nationkey
                        and c_nationkey = n2.n_nationkey
                        and (
                                (n1.n_name = 'KENYA' and n2.n_name = 'PERU')
                                or (n1.n_name = 'PERU' and n2.n_name = 'KENYA')
                        )
                        and l_shipdate between cast('1995-01-01' as timestamp) and cast('1996-12-31' as timestamp)
        ) as shipping
group by
        supp_nation,
        cust_nation,
        l_year
order by
        supp_nation,
        cust_nation,
        l_year,,)
Time :4.929 ] 

 
23.364 [ Query :Query(select
        o_year,
        sum(case
                when nation = 'PERU' then volume
                else 0
        end) / sum(volume) as mkt_share
from
        (
                select
                        year(o_orderdate) as o_year,
                        l_extendedprice * (1 - l_discount) as volume,
                        n2.n_name as nation
                from
                        part,
                        supplier,
                        lineitem,
                        orders,
                        customer,
                        nation n1,
                        nation n2,
                        region
                where
                        p_partkey = l_partkey
                        and s_suppkey = l_suppkey
                        and l_orderkey = o_orderkey
                        and o_custkey = c_custkey
                        and c_nationkey = n1.n_nationkey
                        and n1.n_regionkey = r_regionkey
                        and r_name = 'AMERICA'
                        and s_nationkey = n2.n_nationkey
                        and o_orderdate between cast('1995-01-01' as timestamp) and  cast('1996-12-31' as timestamp)
                        and p_type = 'ECONOMY BURNISHED NICKEL'
        ) as all_nations
group by
        o_year
order by
        o_year,,)
Time :23.364 ] 

 
5.744 [ Query :Query(select
        c_custkey,
        c_name,
        sum(l_extendedprice * (1 - l_discount)) as revenue,
        c_acctbal,
        n_name,
        c_address,
        c_phone,
        c_comment
from
        customer,
        orders,
        lineitem,
        nation
where
        c_custkey = o_custkey
        and l_orderkey = o_orderkey
        and o_orderdate >= cast('1993-07-01' as timestamp)
        and o_orderdate < cast('1993-10-01' as timestamp)
        and l_returnflag = 'R'
        and c_nationkey = n_nationkey
group by
        c_custkey,
        c_name,
        c_acctbal,
        c_phone,
        n_name,
        c_address,
        c_comment
order by
        revenue desc
limit 20,,)
Time :5.744 ] 

 
4.276 [ Query :Query(select
        l_shipmode,
        sum(case
                when o_orderpriority = '1-URGENT'
                        or o_orderpriority = '2-HIGH'
                        then 1
                else 0
        end) as high_line_count,
        sum(case
                when o_orderpriority <> '1-URGENT'
                        and o_orderpriority <> '2-HIGH'
                        then 1
                else 0
        end) as low_line_count
from
        orders,
        lineitem
where
        o_orderkey = l_orderkey
        and l_shipmode in ('REG AIR', 'MAIL')
        and l_commitdate < l_receiptdate
        and l_shipdate < l_commitdate
        and l_receiptdate >= cast('1995-01-01' as timestamp) 
        and l_receiptdate < cast('1996-01-01' as timestamp) 
group by
        l_shipmode
order by
        l_shipmode,,)
Time :4.276 ] 

 
7.914 [ Query :Query(select
        c_count,
        count(*) as custdist
from
        (
                select
                        c_custkey,
                        count(o_orderkey) as c_count
                from
                        customer left outer join orders on
                                c_custkey = o_custkey
                                and o_comment not like '%unusual%accounts%'
                group by
                        c_custkey
        ) c_orders
group by
        c_count
order by
        custdist desc,
        c_count desc,,)
Time :7.914 ] 

 
1.106 [ Query :Query(select
        100.00 * sum(case
                when p_type like 'PROMO%'
                        then l_extendedprice * (1 - l_discount)
                else 0
        end) / sum(l_extendedprice * (1 - l_discount)) as promo_revenue
from
        lineitem,
        part
where
        l_partkey = p_partkey
        and l_shipdate >= cast('1995-08-01' as timestamp) 
        and l_shipdate < cast('1995-09-01' as timestamp),,)
Time :1.106 ] 

 
3.153 [ Query :Query(select
        p_brand,
        p_type,
        p_size,
        count(distinct ps_suppkey) as supplier_cnt
from
        partsupp,
        part
where
        p_partkey = ps_partkey
        and p_brand <> 'Brand#34'
        and p_type not like 'ECONOMY BRUSHED%'
        and p_size in (22, 14, 27, 49, 21, 33, 35, 28)
        and partsupp.ps_suppkey not in (
                select
                        s_suppkey
                from
                        supplier
                where
                        s_comment like '%Customer%Complaints%'
        )
group by
        p_brand,
        p_type,
        p_size
order by
        supplier_cnt desc,
        p_brand,
        p_type,
        p_size,,)
Time :3.153 ] 

 
0.745 [ Query :Query(with q17_part as (
  select p_partkey from part where  
  p_brand = 'Brand#23'
  and p_container = 'MED BOX'
),
q17_avg as (
  select l_partkey as t_partkey, 0.2 * avg(l_quantity) as t_avg_quantity
  from lineitem 
  where l_partkey IN (select p_partkey from q17_part)
  group by l_partkey
),
q17_price as (
  select
  l_quantity,
  l_partkey,
  l_extendedprice
  from
  lineitem
  where
  l_partkey IN (select p_partkey from q17_part)
)
select cast(sum(l_extendedprice) / 7.0 as decimal(32,2)) as avg_yearly
from q17_avg, q17_price
where 
t_partkey = l_partkey and l_quantity < t_avg_quantity,,)
Time :0.745 ] 

 
3.397 [ Query :Query(-- explain formatted 
with tmp1 as (
    select p_partkey from part where p_name like 'forest%'
),
tmp2 as (
    select s_name, s_address, s_suppkey
    from supplier, nation
    where s_nationkey = n_nationkey
    and n_name = 'CANADA'
),
tmp3 as (
    select l_partkey, 0.5 * sum(l_quantity) as sum_quantity, l_suppkey
    from lineitem, tmp2
    where l_shipdate >= cast('1994-01-01' as timestamp) and l_shipdate <= cast('1995-01-01' as timestamp)
    and l_suppkey = s_suppkey 
    group by l_partkey, l_suppkey
),
tmp4 as (
    select ps_partkey, ps_suppkey, ps_availqty
    from partsupp 
    where ps_partkey IN (select p_partkey from tmp1)
),
tmp5 as (
select
    ps_suppkey
from
    tmp4, tmp3
where
    ps_partkey = l_partkey
    and ps_suppkey = l_suppkey
    and ps_availqty > sum_quantity
)
select
    s_name,
    s_address
from
    supplier
where
    s_suppkey IN (select ps_suppkey from tmp5)
order by s_name,,)
Time :3.397 ] 

 
6.609 [ Query :Query(select
        l_returnflag,
        l_linestatus,
        sum(l_quantity) as sum_qty,
        sum(l_extendedprice) as sum_base_price,
        sum(l_extendedprice * (1 - l_discount)) as sum_disc_price,
        sum(l_extendedprice * (1 - l_discount) * (1 + l_tax)) as sum_charge,
        avg(l_quantity) as avg_qty,
        avg(l_extendedprice) as avg_price,
        avg(l_discount) as avg_disc,
        count(*) as count_order
from
        lineitem
where
        l_shipdate <= cast('1998-09-16' as timestamp)
group by
        l_returnflag,
        l_linestatus
order by
        l_returnflag,
        l_linestatus,,)
Time :6.609 ] 

 
8.33 [ Query :Query(select
        l_orderkey,
        sum(l_extendedprice * (1 - l_discount)) as revenue,
        o_orderdate,
        o_shippriority
from
        customer,
        orders,
        lineitem
where
        c_mktsegment = 'BUILDING'
        and c_custkey = o_custkey
        and l_orderkey = o_orderkey
        and o_orderdate <  cast('1995-03-22' as timestamp)
        and l_shipdate > cast('1995-03-22' as timestamp)
group by
        l_orderkey,
        o_orderdate,
        o_shippriority
order by
        revenue desc,
        o_orderdate
limit 10,,)
Time :8.33 ] 

 
3.899 [ Query :Query(select
        o_orderpriority,
        count(*) as order_count
from
        orders as o
where
        o_orderdate >= cast('1996-05-01' as timestamp)
        and o_orderdate < cast('1996-08-01' as timestamp)
        and exists (
                select
                        *
                from
                        lineitem
                where
                        l_orderkey = o.o_orderkey
                        and l_commitdate < l_receiptdate
        )
group by
        o_orderpriority
order by
        o_orderpriority,,)
Time :3.899 ] 

 
5.275 [ Query :Query(select
        n_name,
        sum(l_extendedprice * (1 - l_discount)) as revenue
from
        customer,
        orders,
        lineitem,
        supplier,
        nation,
        region
where
        c_custkey = o_custkey
        and l_orderkey = o_orderkey
        and l_suppkey = s_suppkey
        and c_nationkey = s_nationkey
        and s_nationkey = n_nationkey
        and n_regionkey = r_regionkey
        and r_name = 'AFRICA'
        and o_orderdate >= cast('1993-01-01' as timestamp)
        and o_orderdate < cast('1994-01-01' as timestamp)
group by
        n_name
order by
        revenue desc,,)
Time :5.275 ] 

 
3.862 [ Query :Query(select
        o_orderpriority,
        count(*) as order_count
from
        orders as o
where
        o_orderdate >= cast('1996-05-01' as timestamp)
        and o_orderdate < cast('1996-08-01' as timestamp)
        and exists (
                select
                        *
                from
                        lineitem
                where
                        l_orderkey = o.o_orderkey
                        and l_commitdate < l_receiptdate
        )
group by
        o_orderpriority
order by
        o_orderpriority,,)
Time :3.862 ] 

 
5.694 [ Query :Query(select
        n_name,
        sum(l_extendedprice * (1 - l_discount)) as revenue
from
        customer,
        orders,
        lineitem,
        supplier,
        nation,
        region
where
        c_custkey = o_custkey
        and l_orderkey = o_orderkey
        and l_suppkey = s_suppkey
        and c_nationkey = s_nationkey
        and s_nationkey = n_nationkey
        and n_regionkey = r_regionkey
        and r_name = 'AFRICA'
        and o_orderdate >= cast('1993-01-01' as timestamp)
        and o_orderdate < cast('1994-01-01' as timestamp) 
group by
        n_name
order by
        revenue desc,,)
Time :5.694 ] 

 
0.332 [ Query :Query(select
        sum(l_extendedprice * l_discount) as revenue
from
        lineitem
where
        l_shipdate >= cast('1993-01-01' as timestamp)
        and l_shipdate < cast('1994-01-01' as timestamp) 
        and l_discount between 0.06 - 0.01 and 0.06 + 0.01
        and l_quantity < 25,,)
Time :0.332 ] 

 
4.664 [ Query :Query(select
        supp_nation,
        cust_nation,
        l_year,
        sum(volume) as revenue
from
        (
                select
                        n1.n_name as supp_nation,
                        n2.n_name as cust_nation,
                        year(l_shipdate) as l_year,
                        l_extendedprice * (1 - l_discount) as volume
                from
                        supplier,
                        lineitem,
                        orders,
                        customer,
                        nation n1,
                        nation n2
                where
                        s_suppkey = l_suppkey
                        and o_orderkey = l_orderkey
                        and c_custkey = o_custkey
                        and s_nationkey = n1.n_nationkey
                        and c_nationkey = n2.n_nationkey
                        and (
                                (n1.n_name = 'KENYA' and n2.n_name = 'PERU')
                                or (n1.n_name = 'PERU' and n2.n_name = 'KENYA')
                        )
                        and l_shipdate between cast('1995-01-01' as timestamp) and cast('1996-12-31' as timestamp)
        ) as shipping
group by
        supp_nation,
        cust_nation,
        l_year
order by
        supp_nation,
        cust_nation,
        l_year,,)
Time :4.664 ] 

 
19.917 [ Query :Query(select
        o_year,
        sum(case
                when nation = 'PERU' then volume
                else 0
        end) / sum(volume) as mkt_share
from
        (
                select
                        year(o_orderdate) as o_year,
                        l_extendedprice * (1 - l_discount) as volume,
                        n2.n_name as nation
                from
                        part,
                        supplier,
                        lineitem,
                        orders,
                        customer,
                        nation n1,
                        nation n2,
                        region
                where
                        p_partkey = l_partkey
                        and s_suppkey = l_suppkey
                        and l_orderkey = o_orderkey
                        and o_custkey = c_custkey
                        and c_nationkey = n1.n_nationkey
                        and n1.n_regionkey = r_regionkey
                        and r_name = 'AMERICA'
                        and s_nationkey = n2.n_nationkey
                        and o_orderdate between cast('1995-01-01' as timestamp) and  cast('1996-12-31' as timestamp)
                        and p_type = 'ECONOMY BURNISHED NICKEL'
        ) as all_nations
group by
        o_year
order by
        o_year,,)
Time :19.917 ] 

 
4.822 [ Query :Query(select
        c_custkey,
        c_name,
        sum(l_extendedprice * (1 - l_discount)) as revenue,
        c_acctbal,
        n_name,
        c_address,
        c_phone,
        c_comment
from
        customer,
        orders,
        lineitem,
        nation
where
        c_custkey = o_custkey
        and l_orderkey = o_orderkey
        and o_orderdate >= cast('1993-07-01' as timestamp)
        and o_orderdate < cast('1993-10-01' as timestamp)
        and l_returnflag = 'R'
        and c_nationkey = n_nationkey
group by
        c_custkey,
        c_name,
        c_acctbal,
        c_phone,
        n_name,
        c_address,
        c_comment
order by
        revenue desc
limit 20,,)
Time :4.822 ] 

 
2.905 [ Query :Query(select
        l_shipmode,
        sum(case
                when o_orderpriority = '1-URGENT'
                        or o_orderpriority = '2-HIGH'
                        then 1
                else 0
        end) as high_line_count,
        sum(case
                when o_orderpriority <> '1-URGENT'
                        and o_orderpriority <> '2-HIGH'
                        then 1
                else 0
        end) as low_line_count
from
        orders,
        lineitem
where
        o_orderkey = l_orderkey
        and l_shipmode in ('REG AIR', 'MAIL')
        and l_commitdate < l_receiptdate
        and l_shipdate < l_commitdate
        and l_receiptdate >= cast('1995-01-01' as timestamp) 
        and l_receiptdate < cast('1996-01-01' as timestamp) 
group by
        l_shipmode
order by
        l_shipmode,,)
Time :2.905 ] 

 
7.34 [ Query :Query(select
        c_count,
        count(*) as custdist
from
        (
                select
                        c_custkey,
                        count(o_orderkey) as c_count
                from
                        customer left outer join orders on
                                c_custkey = o_custkey
                                and o_comment not like '%unusual%accounts%'
                group by
                        c_custkey
        ) c_orders
group by
        c_count
order by
        custdist desc,
        c_count desc,,)
Time :7.34 ] 

 
0.807 [ Query :Query(select
        100.00 * sum(case
                when p_type like 'PROMO%'
                        then l_extendedprice * (1 - l_discount)
                else 0
        end) / sum(l_extendedprice * (1 - l_discount)) as promo_revenue
from
        lineitem,
        part
where
        l_partkey = p_partkey
        and l_shipdate >= cast('1995-08-01' as timestamp) 
        and l_shipdate < cast('1995-09-01' as timestamp),,)
Time :0.807 ] 

 
3.119 [ Query :Query(select
        p_brand,
        p_type,
        p_size,
        count(distinct ps_suppkey) as supplier_cnt
from
        partsupp,
        part
where
        p_partkey = ps_partkey
        and p_brand <> 'Brand#34'
        and p_type not like 'ECONOMY BRUSHED%'
        and p_size in (22, 14, 27, 49, 21, 33, 35, 28)
        and partsupp.ps_suppkey not in (
                select
                        s_suppkey
                from
                        supplier
                where
                        s_comment like '%Customer%Complaints%'
        )
group by
        p_brand,
        p_type,
        p_size
order by
        supplier_cnt desc,
        p_brand,
        p_type,
        p_size,,)
Time :3.119 ] 

 
0.451 [ Query :Query(with q17_part as (
  select p_partkey from part where  
  p_brand = 'Brand#23'
  and p_container = 'MED BOX'
),
q17_avg as (
  select l_partkey as t_partkey, 0.2 * avg(l_quantity) as t_avg_quantity
  from lineitem 
  where l_partkey IN (select p_partkey from q17_part)
  group by l_partkey
),
q17_price as (
  select
  l_quantity,
  l_partkey,
  l_extendedprice
  from
  lineitem
  where
  l_partkey IN (select p_partkey from q17_part)
)
select cast(sum(l_extendedprice) / 7.0 as decimal(32,2)) as avg_yearly
from q17_avg, q17_price
where 
t_partkey = l_partkey and l_quantity < t_avg_quantity,,)
Time :0.451 ] 

 
2.375 [ Query :Query(-- explain formatted 
with tmp1 as (
    select p_partkey from part where p_name like 'forest%'
),
tmp2 as (
    select s_name, s_address, s_suppkey
    from supplier, nation
    where s_nationkey = n_nationkey
    and n_name = 'CANADA'
),
tmp3 as (
    select l_partkey, 0.5 * sum(l_quantity) as sum_quantity, l_suppkey
    from lineitem, tmp2
    where l_shipdate >= cast('1994-01-01' as timestamp) and l_shipdate <= cast('1995-01-01' as timestamp)
    and l_suppkey = s_suppkey 
    group by l_partkey, l_suppkey
),
tmp4 as (
    select ps_partkey, ps_suppkey, ps_availqty
    from partsupp 
    where ps_partkey IN (select p_partkey from tmp1)
),
tmp5 as (
select
    ps_suppkey
from
    tmp4, tmp3
where
    ps_partkey = l_partkey
    and ps_suppkey = l_suppkey
    and ps_availqty > sum_quantity
)
select
    s_name,
    s_address
from
    supplier
where
    s_suppkey IN (select ps_suppkey from tmp5)
order by s_name,,)
Time :2.375 ] 

 
5.428 [ Query :Query(select
        l_returnflag,
        l_linestatus,
        sum(l_quantity) as sum_qty,
        sum(l_extendedprice) as sum_base_price,
        sum(l_extendedprice * (1 - l_discount)) as sum_disc_price,
        sum(l_extendedprice * (1 - l_discount) * (1 + l_tax)) as sum_charge,
        avg(l_quantity) as avg_qty,
        avg(l_extendedprice) as avg_price,
        avg(l_discount) as avg_disc,
        count(*) as count_order
from
        lineitem
where
        l_shipdate <= cast('1998-09-16' as timestamp)
group by
        l_returnflag,
        l_linestatus
order by
        l_returnflag,
        l_linestatus,,)
Time :5.428 ] 

 
8.005 [ Query :Query(select
        l_orderkey,
        sum(l_extendedprice * (1 - l_discount)) as revenue,
        o_orderdate,
        o_shippriority
from
        customer,
        orders,
        lineitem
where
        c_mktsegment = 'BUILDING'
        and c_custkey = o_custkey
        and l_orderkey = o_orderkey
        and o_orderdate <  cast('1995-03-22' as timestamp)
        and l_shipdate > cast('1995-03-22' as timestamp)
group by
        l_orderkey,
        o_orderdate,
        o_shippriority
order by
        revenue desc,
        o_orderdate
limit 10,,)
Time :8.005 ] 

 
5.167 [ Query :Query(select
        o_orderpriority,
        count(*) as order_count
from
        orders as o
where
        o_orderdate >= cast('1996-05-01' as timestamp)
        and o_orderdate < cast('1996-08-01' as timestamp)
        and exists (
                select
                        *
                from
                        lineitem
                where
                        l_orderkey = o.o_orderkey
                        and l_commitdate < l_receiptdate
        )
group by
        o_orderpriority
order by
        o_orderpriority,,)
Time :5.167 ] 

 
5.784 [ Query :Query(select
        n_name,
        sum(l_extendedprice * (1 - l_discount)) as revenue
from
        customer,
        orders,
        lineitem,
        supplier,
        nation,
        region
where
        c_custkey = o_custkey
        and l_orderkey = o_orderkey
        and l_suppkey = s_suppkey
        and c_nationkey = s_nationkey
        and s_nationkey = n_nationkey
        and n_regionkey = r_regionkey
        and r_name = 'AFRICA'
        and o_orderdate >= cast('1993-01-01' as timestamp)
        and o_orderdate < cast('1994-01-01' as timestamp)
group by
        n_name
order by
        revenue desc,,)
Time :5.784 ] 

 
3.5 [ Query :Query(select
        o_orderpriority,
        count(*) as order_count
from
        orders as o
where
        o_orderdate >= cast('1996-05-01' as timestamp)
        and o_orderdate < cast('1996-08-01' as timestamp)
        and exists (
                select
                        *
                from
                        lineitem
                where
                        l_orderkey = o.o_orderkey
                        and l_commitdate < l_receiptdate
        )
group by
        o_orderpriority
order by
        o_orderpriority,,)
Time :3.5 ] 

 
4.802 [ Query :Query(select
        n_name,
        sum(l_extendedprice * (1 - l_discount)) as revenue
from
        customer,
        orders,
        lineitem,
        supplier,
        nation,
        region
where
        c_custkey = o_custkey
        and l_orderkey = o_orderkey
        and l_suppkey = s_suppkey
        and c_nationkey = s_nationkey
        and s_nationkey = n_nationkey
        and n_regionkey = r_regionkey
        and r_name = 'AFRICA'
        and o_orderdate >= cast('1993-01-01' as timestamp)
        and o_orderdate < cast('1994-01-01' as timestamp) 
group by
        n_name
order by
        revenue desc,,)
Time :4.802 ] 

 
0.312 [ Query :Query(select
        sum(l_extendedprice * l_discount) as revenue
from
        lineitem
where
        l_shipdate >= cast('1993-01-01' as timestamp)
        and l_shipdate < cast('1994-01-01' as timestamp) 
        and l_discount between 0.06 - 0.01 and 0.06 + 0.01
        and l_quantity < 25,,)
Time :0.312 ] 

 
5.178 [ Query :Query(select
        supp_nation,
        cust_nation,
        l_year,
        sum(volume) as revenue
from
        (
                select
                        n1.n_name as supp_nation,
                        n2.n_name as cust_nation,
                        year(l_shipdate) as l_year,
                        l_extendedprice * (1 - l_discount) as volume
                from
                        supplier,
                        lineitem,
                        orders,
                        customer,
                        nation n1,
                        nation n2
                where
                        s_suppkey = l_suppkey
                        and o_orderkey = l_orderkey
                        and c_custkey = o_custkey
                        and s_nationkey = n1.n_nationkey
                        and c_nationkey = n2.n_nationkey
                        and (
                                (n1.n_name = 'KENYA' and n2.n_name = 'PERU')
                                or (n1.n_name = 'PERU' and n2.n_name = 'KENYA')
                        )
                        and l_shipdate between cast('1995-01-01' as timestamp) and cast('1996-12-31' as timestamp)
        ) as shipping
group by
        supp_nation,
        cust_nation,
        l_year
order by
        supp_nation,
        cust_nation,
        l_year,,)
Time :5.178 ] 

 
22.143 [ Query :Query(select
        o_year,
        sum(case
                when nation = 'PERU' then volume
                else 0
        end) / sum(volume) as mkt_share
from
        (
                select
                        year(o_orderdate) as o_year,
                        l_extendedprice * (1 - l_discount) as volume,
                        n2.n_name as nation
                from
                        part,
                        supplier,
                        lineitem,
                        orders,
                        customer,
                        nation n1,
                        nation n2,
                        region
                where
                        p_partkey = l_partkey
                        and s_suppkey = l_suppkey
                        and l_orderkey = o_orderkey
                        and o_custkey = c_custkey
                        and c_nationkey = n1.n_nationkey
                        and n1.n_regionkey = r_regionkey
                        and r_name = 'AMERICA'
                        and s_nationkey = n2.n_nationkey
                        and o_orderdate between cast('1995-01-01' as timestamp) and  cast('1996-12-31' as timestamp)
                        and p_type = 'ECONOMY BURNISHED NICKEL'
        ) as all_nations
group by
        o_year
order by
        o_year,,)
Time :22.143 ] 

 
5.395 [ Query :Query(select
        c_custkey,
        c_name,
        sum(l_extendedprice * (1 - l_discount)) as revenue,
        c_acctbal,
        n_name,
        c_address,
        c_phone,
        c_comment
from
        customer,
        orders,
        lineitem,
        nation
where
        c_custkey = o_custkey
        and l_orderkey = o_orderkey
        and o_orderdate >= cast('1993-07-01' as timestamp)
        and o_orderdate < cast('1993-10-01' as timestamp)
        and l_returnflag = 'R'
        and c_nationkey = n_nationkey
group by
        c_custkey,
        c_name,
        c_acctbal,
        c_phone,
        n_name,
        c_address,
        c_comment
order by
        revenue desc
limit 20,,)
Time :5.395 ] 

 
4.459 [ Query :Query(select
        l_shipmode,
        sum(case
                when o_orderpriority = '1-URGENT'
                        or o_orderpriority = '2-HIGH'
                        then 1
                else 0
        end) as high_line_count,
        sum(case
                when o_orderpriority <> '1-URGENT'
                        and o_orderpriority <> '2-HIGH'
                        then 1
                else 0
        end) as low_line_count
from
        orders,
        lineitem
where
        o_orderkey = l_orderkey
        and l_shipmode in ('REG AIR', 'MAIL')
        and l_commitdate < l_receiptdate
        and l_shipdate < l_commitdate
        and l_receiptdate >= cast('1995-01-01' as timestamp) 
        and l_receiptdate < cast('1996-01-01' as timestamp) 
group by
        l_shipmode
order by
        l_shipmode,,)
Time :4.459 ] 

 
7.721 [ Query :Query(select
        c_count,
        count(*) as custdist
from
        (
                select
                        c_custkey,
                        count(o_orderkey) as c_count
                from
                        customer left outer join orders on
                                c_custkey = o_custkey
                                and o_comment not like '%unusual%accounts%'
                group by
                        c_custkey
        ) c_orders
group by
        c_count
order by
        custdist desc,
        c_count desc,,)
Time :7.721 ] 

 
1.038 [ Query :Query(select
        100.00 * sum(case
                when p_type like 'PROMO%'
                        then l_extendedprice * (1 - l_discount)
                else 0
        end) / sum(l_extendedprice * (1 - l_discount)) as promo_revenue
from
        lineitem,
        part
where
        l_partkey = p_partkey
        and l_shipdate >= cast('1995-08-01' as timestamp) 
        and l_shipdate < cast('1995-09-01' as timestamp),,)
Time :1.038 ] 

 
4.218 [ Query :Query(select
        p_brand,
        p_type,
        p_size,
        count(distinct ps_suppkey) as supplier_cnt
from
        partsupp,
        part
where
        p_partkey = ps_partkey
        and p_brand <> 'Brand#34'
        and p_type not like 'ECONOMY BRUSHED%'
        and p_size in (22, 14, 27, 49, 21, 33, 35, 28)
        and partsupp.ps_suppkey not in (
                select
                        s_suppkey
                from
                        supplier
                where
                        s_comment like '%Customer%Complaints%'
        )
group by
        p_brand,
        p_type,
        p_size
order by
        supplier_cnt desc,
        p_brand,
        p_type,
        p_size,,)
Time :4.218 ] 

 
0.477 [ Query :Query(with q17_part as (
  select p_partkey from part where  
  p_brand = 'Brand#23'
  and p_container = 'MED BOX'
),
q17_avg as (
  select l_partkey as t_partkey, 0.2 * avg(l_quantity) as t_avg_quantity
  from lineitem 
  where l_partkey IN (select p_partkey from q17_part)
  group by l_partkey
),
q17_price as (
  select
  l_quantity,
  l_partkey,
  l_extendedprice
  from
  lineitem
  where
  l_partkey IN (select p_partkey from q17_part)
)
select cast(sum(l_extendedprice) / 7.0 as decimal(32,2)) as avg_yearly
from q17_avg, q17_price
where 
t_partkey = l_partkey and l_quantity < t_avg_quantity,,)
Time :0.477 ] 

 
2.856 [ Query :Query(-- explain formatted 
with tmp1 as (
    select p_partkey from part where p_name like 'forest%'
),
tmp2 as (
    select s_name, s_address, s_suppkey
    from supplier, nation
    where s_nationkey = n_nationkey
    and n_name = 'CANADA'
),
tmp3 as (
    select l_partkey, 0.5 * sum(l_quantity) as sum_quantity, l_suppkey
    from lineitem, tmp2
    where l_shipdate >= cast('1994-01-01' as timestamp) and l_shipdate <= cast('1995-01-01' as timestamp)
    and l_suppkey = s_suppkey 
    group by l_partkey, l_suppkey
),
tmp4 as (
    select ps_partkey, ps_suppkey, ps_availqty
    from partsupp 
    where ps_partkey IN (select p_partkey from tmp1)
),
tmp5 as (
select
    ps_suppkey
from
    tmp4, tmp3
where
    ps_partkey = l_partkey
    and ps_suppkey = l_suppkey
    and ps_availqty > sum_quantity
)
select
    s_name,
    s_address
from
    supplier
where
    s_suppkey IN (select ps_suppkey from tmp5)
order by s_name,,)
Time :2.856 ] 

 
6.118 [ Query :Query(select
        l_returnflag,
        l_linestatus,
        sum(l_quantity) as sum_qty,
        sum(l_extendedprice) as sum_base_price,
        sum(l_extendedprice * (1 - l_discount)) as sum_disc_price,
        sum(l_extendedprice * (1 - l_discount) * (1 + l_tax)) as sum_charge,
        avg(l_quantity) as avg_qty,
        avg(l_extendedprice) as avg_price,
        avg(l_discount) as avg_disc,
        count(*) as count_order
from
        lineitem
where
        l_shipdate <= cast('1998-09-16' as timestamp)
group by
        l_returnflag,
        l_linestatus
order by
        l_returnflag,
        l_linestatus,,)
Time :6.118 ] 

 
7.918 [ Query :Query(select
        l_orderkey,
        sum(l_extendedprice * (1 - l_discount)) as revenue,
        o_orderdate,
        o_shippriority
from
        customer,
        orders,
        lineitem
where
        c_mktsegment = 'BUILDING'
        and c_custkey = o_custkey
        and l_orderkey = o_orderkey
        and o_orderdate <  cast('1995-03-22' as timestamp)
        and l_shipdate > cast('1995-03-22' as timestamp)
group by
        l_orderkey,
        o_orderdate,
        o_shippriority
order by
        revenue desc,
        o_orderdate
limit 10,,)
Time :7.918 ] 

 
4.89 [ Query :Query(select
        o_orderpriority,
        count(*) as order_count
from
        orders as o
where
        o_orderdate >= cast('1996-05-01' as timestamp)
        and o_orderdate < cast('1996-08-01' as timestamp)
        and exists (
                select
                        *
                from
                        lineitem
                where
                        l_orderkey = o.o_orderkey
                        and l_commitdate < l_receiptdate
        )
group by
        o_orderpriority
order by
        o_orderpriority,,)
Time :4.89 ] 

 
6.166 [ Query :Query(select
        n_name,
        sum(l_extendedprice * (1 - l_discount)) as revenue
from
        customer,
        orders,
        lineitem,
        supplier,
        nation,
        region
where
        c_custkey = o_custkey
        and l_orderkey = o_orderkey
        and l_suppkey = s_suppkey
        and c_nationkey = s_nationkey
        and s_nationkey = n_nationkey
        and n_regionkey = r_regionkey
        and r_name = 'AFRICA'
        and o_orderdate >= cast('1993-01-01' as timestamp)
        and o_orderdate < cast('1994-01-01' as timestamp)
group by
        n_name
order by
        revenue desc,,)
Time :6.166 ] 

 
3.881 [ Query :Query(select
        o_orderpriority,
        count(*) as order_count
from
        orders as o
where
        o_orderdate >= cast('1996-05-01' as timestamp)
        and o_orderdate < cast('1996-08-01' as timestamp)
        and exists (
                select
                        *
                from
                        lineitem
                where
                        l_orderkey = o.o_orderkey
                        and l_commitdate < l_receiptdate
        )
group by
        o_orderpriority
order by
        o_orderpriority,,)
Time :3.881 ] 

 
4.881 [ Query :Query(select
        n_name,
        sum(l_extendedprice * (1 - l_discount)) as revenue
from
        customer,
        orders,
        lineitem,
        supplier,
        nation,
        region
where
        c_custkey = o_custkey
        and l_orderkey = o_orderkey
        and l_suppkey = s_suppkey
        and c_nationkey = s_nationkey
        and s_nationkey = n_nationkey
        and n_regionkey = r_regionkey
        and r_name = 'AFRICA'
        and o_orderdate >= cast('1993-01-01' as timestamp)
        and o_orderdate < cast('1994-01-01' as timestamp) 
group by
        n_name
order by
        revenue desc,,)
Time :4.881 ] 

 
0.279 [ Query :Query(select
        sum(l_extendedprice * l_discount) as revenue
from
        lineitem
where
        l_shipdate >= cast('1993-01-01' as timestamp)
        and l_shipdate < cast('1994-01-01' as timestamp) 
        and l_discount between 0.06 - 0.01 and 0.06 + 0.01
        and l_quantity < 25,,)
Time :0.279 ] 

 
4.804 [ Query :Query(select
        supp_nation,
        cust_nation,
        l_year,
        sum(volume) as revenue
from
        (
                select
                        n1.n_name as supp_nation,
                        n2.n_name as cust_nation,
                        year(l_shipdate) as l_year,
                        l_extendedprice * (1 - l_discount) as volume
                from
                        supplier,
                        lineitem,
                        orders,
                        customer,
                        nation n1,
                        nation n2
                where
                        s_suppkey = l_suppkey
                        and o_orderkey = l_orderkey
                        and c_custkey = o_custkey
                        and s_nationkey = n1.n_nationkey
                        and c_nationkey = n2.n_nationkey
                        and (
                                (n1.n_name = 'KENYA' and n2.n_name = 'PERU')
                                or (n1.n_name = 'PERU' and n2.n_name = 'KENYA')
                        )
                        and l_shipdate between cast('1995-01-01' as timestamp) and cast('1996-12-31' as timestamp)
        ) as shipping
group by
        supp_nation,
        cust_nation,
        l_year
order by
        supp_nation,
        cust_nation,
        l_year,,)
Time :4.804 ] 

 
21.501 [ Query :Query(select
        o_year,
        sum(case
                when nation = 'PERU' then volume
                else 0
        end) / sum(volume) as mkt_share
from
        (
                select
                        year(o_orderdate) as o_year,
                        l_extendedprice * (1 - l_discount) as volume,
                        n2.n_name as nation
                from
                        part,
                        supplier,
                        lineitem,
                        orders,
                        customer,
                        nation n1,
                        nation n2,
                        region
                where
                        p_partkey = l_partkey
                        and s_suppkey = l_suppkey
                        and l_orderkey = o_orderkey
                        and o_custkey = c_custkey
                        and c_nationkey = n1.n_nationkey
                        and n1.n_regionkey = r_regionkey
                        and r_name = 'AMERICA'
                        and s_nationkey = n2.n_nationkey
                        and o_orderdate between cast('1995-01-01' as timestamp) and  cast('1996-12-31' as timestamp)
                        and p_type = 'ECONOMY BURNISHED NICKEL'
        ) as all_nations
group by
        o_year
order by
        o_year,,)
Time :21.501 ] 

 
6.03 [ Query :Query(select
        c_custkey,
        c_name,
        sum(l_extendedprice * (1 - l_discount)) as revenue,
        c_acctbal,
        n_name,
        c_address,
        c_phone,
        c_comment
from
        customer,
        orders,
        lineitem,
        nation
where
        c_custkey = o_custkey
        and l_orderkey = o_orderkey
        and o_orderdate >= cast('1993-07-01' as timestamp)
        and o_orderdate < cast('1993-10-01' as timestamp)
        and l_returnflag = 'R'
        and c_nationkey = n_nationkey
group by
        c_custkey,
        c_name,
        c_acctbal,
        c_phone,
        n_name,
        c_address,
        c_comment
order by
        revenue desc
limit 20,,)
Time :6.03 ] 

 
4.646 [ Query :Query(select
        l_shipmode,
        sum(case
                when o_orderpriority = '1-URGENT'
                        or o_orderpriority = '2-HIGH'
                        then 1
                else 0
        end) as high_line_count,
        sum(case
                when o_orderpriority <> '1-URGENT'
                        and o_orderpriority <> '2-HIGH'
                        then 1
                else 0
        end) as low_line_count
from
        orders,
        lineitem
where
        o_orderkey = l_orderkey
        and l_shipmode in ('REG AIR', 'MAIL')
        and l_commitdate < l_receiptdate
        and l_shipdate < l_commitdate
        and l_receiptdate >= cast('1995-01-01' as timestamp) 
        and l_receiptdate < cast('1996-01-01' as timestamp) 
group by
        l_shipmode
order by
        l_shipmode,,)
Time :4.646 ] 

 
8.049 [ Query :Query(select
        c_count,
        count(*) as custdist
from
        (
                select
                        c_custkey,
                        count(o_orderkey) as c_count
                from
                        customer left outer join orders on
                                c_custkey = o_custkey
                                and o_comment not like '%unusual%accounts%'
                group by
                        c_custkey
        ) c_orders
group by
        c_count
order by
        custdist desc,
        c_count desc,,)
Time :8.049 ] 

 
1.047 [ Query :Query(select
        100.00 * sum(case
                when p_type like 'PROMO%'
                        then l_extendedprice * (1 - l_discount)
                else 0
        end) / sum(l_extendedprice * (1 - l_discount)) as promo_revenue
from
        lineitem,
        part
where
        l_partkey = p_partkey
        and l_shipdate >= cast('1995-08-01' as timestamp) 
        and l_shipdate < cast('1995-09-01' as timestamp),,)
Time :1.047 ] 

 
3.472 [ Query :Query(select
        p_brand,
        p_type,
        p_size,
        count(distinct ps_suppkey) as supplier_cnt
from
        partsupp,
        part
where
        p_partkey = ps_partkey
        and p_brand <> 'Brand#34'
        and p_type not like 'ECONOMY BRUSHED%'
        and p_size in (22, 14, 27, 49, 21, 33, 35, 28)
        and partsupp.ps_suppkey not in (
                select
                        s_suppkey
                from
                        supplier
                where
                        s_comment like '%Customer%Complaints%'
        )
group by
        p_brand,
        p_type,
        p_size
order by
        supplier_cnt desc,
        p_brand,
        p_type,
        p_size,,)
Time :3.472 ] 

 
0.603 [ Query :Query(with q17_part as (
  select p_partkey from part where  
  p_brand = 'Brand#23'
  and p_container = 'MED BOX'
),
q17_avg as (
  select l_partkey as t_partkey, 0.2 * avg(l_quantity) as t_avg_quantity
  from lineitem 
  where l_partkey IN (select p_partkey from q17_part)
  group by l_partkey
),
q17_price as (
  select
  l_quantity,
  l_partkey,
  l_extendedprice
  from
  lineitem
  where
  l_partkey IN (select p_partkey from q17_part)
)
select cast(sum(l_extendedprice) / 7.0 as decimal(32,2)) as avg_yearly
from q17_avg, q17_price
where 
t_partkey = l_partkey and l_quantity < t_avg_quantity,,)
Time :0.603 ] 

 
3.227 [ Query :Query(-- explain formatted 
with tmp1 as (
    select p_partkey from part where p_name like 'forest%'
),
tmp2 as (
    select s_name, s_address, s_suppkey
    from supplier, nation
    where s_nationkey = n_nationkey
    and n_name = 'CANADA'
),
tmp3 as (
    select l_partkey, 0.5 * sum(l_quantity) as sum_quantity, l_suppkey
    from lineitem, tmp2
    where l_shipdate >= cast('1994-01-01' as timestamp) and l_shipdate <= cast('1995-01-01' as timestamp)
    and l_suppkey = s_suppkey 
    group by l_partkey, l_suppkey
),
tmp4 as (
    select ps_partkey, ps_suppkey, ps_availqty
    from partsupp 
    where ps_partkey IN (select p_partkey from tmp1)
),
tmp5 as (
select
    ps_suppkey
from
    tmp4, tmp3
where
    ps_partkey = l_partkey
    and ps_suppkey = l_suppkey
    and ps_availqty > sum_quantity
)
select
    s_name,
    s_address
from
    supplier
where
    s_suppkey IN (select ps_suppkey from tmp5)
order by s_name,,)
Time :3.227 ] 

 
5.656 [ Query :Query(select
        l_returnflag,
        l_linestatus,
        sum(l_quantity) as sum_qty,
        sum(l_extendedprice) as sum_base_price,
        sum(l_extendedprice * (1 - l_discount)) as sum_disc_price,
        sum(l_extendedprice * (1 - l_discount) * (1 + l_tax)) as sum_charge,
        avg(l_quantity) as avg_qty,
        avg(l_extendedprice) as avg_price,
        avg(l_discount) as avg_disc,
        count(*) as count_order
from
        lineitem
where
        l_shipdate <= cast('1998-09-16' as timestamp)
group by
        l_returnflag,
        l_linestatus
order by
        l_returnflag,
        l_linestatus,,)
Time :5.656 ] 

 
9.419 [ Query :Query(select
        l_orderkey,
        sum(l_extendedprice * (1 - l_discount)) as revenue,
        o_orderdate,
        o_shippriority
from
        customer,
        orders,
        lineitem
where
        c_mktsegment = 'BUILDING'
        and c_custkey = o_custkey
        and l_orderkey = o_orderkey
        and o_orderdate <  cast('1995-03-22' as timestamp)
        and l_shipdate > cast('1995-03-22' as timestamp)
group by
        l_orderkey,
        o_orderdate,
        o_shippriority
order by
        revenue desc,
        o_orderdate
limit 10,,)
Time :9.419 ] 

 
5.409 [ Query :Query(select
        o_orderpriority,
        count(*) as order_count
from
        orders as o
where
        o_orderdate >= cast('1996-05-01' as timestamp)
        and o_orderdate < cast('1996-08-01' as timestamp)
        and exists (
                select
                        *
                from
                        lineitem
                where
                        l_orderkey = o.o_orderkey
                        and l_commitdate < l_receiptdate
        )
group by
        o_orderpriority
order by
        o_orderpriority,,)
Time :5.409 ] 

 
6.06 [ Query :Query(select
        n_name,
        sum(l_extendedprice * (1 - l_discount)) as revenue
from
        customer,
        orders,
        lineitem,
        supplier,
        nation,
        region
where
        c_custkey = o_custkey
        and l_orderkey = o_orderkey
        and l_suppkey = s_suppkey
        and c_nationkey = s_nationkey
        and s_nationkey = n_nationkey
        and n_regionkey = r_regionkey
        and r_name = 'AFRICA'
        and o_orderdate >= cast('1993-01-01' as timestamp)
        and o_orderdate < cast('1994-01-01' as timestamp)
group by
        n_name
order by
        revenue desc,,)
Time :6.06 ] 

 
3.996 [ Query :Query(select
        o_orderpriority,
        count(*) as order_count
from
        orders as o
where
        o_orderdate >= cast('1996-05-01' as timestamp)
        and o_orderdate < cast('1996-08-01' as timestamp)
        and exists (
                select
                        *
                from
                        lineitem
                where
                        l_orderkey = o.o_orderkey
                        and l_commitdate < l_receiptdate
        )
group by
        o_orderpriority
order by
        o_orderpriority,,)
Time :3.996 ] 

 
4.854 [ Query :Query(select
        n_name,
        sum(l_extendedprice * (1 - l_discount)) as revenue
from
        customer,
        orders,
        lineitem,
        supplier,
        nation,
        region
where
        c_custkey = o_custkey
        and l_orderkey = o_orderkey
        and l_suppkey = s_suppkey
        and c_nationkey = s_nationkey
        and s_nationkey = n_nationkey
        and n_regionkey = r_regionkey
        and r_name = 'AFRICA'
        and o_orderdate >= cast('1993-01-01' as timestamp)
        and o_orderdate < cast('1994-01-01' as timestamp) 
group by
        n_name
order by
        revenue desc,,)
Time :4.854 ] 

 
0.344 [ Query :Query(select
        sum(l_extendedprice * l_discount) as revenue
from
        lineitem
where
        l_shipdate >= cast('1993-01-01' as timestamp)
        and l_shipdate < cast('1994-01-01' as timestamp) 
        and l_discount between 0.06 - 0.01 and 0.06 + 0.01
        and l_quantity < 25,,)
Time :0.344 ] 

 
4.703 [ Query :Query(select
        supp_nation,
        cust_nation,
        l_year,
        sum(volume) as revenue
from
        (
                select
                        n1.n_name as supp_nation,
                        n2.n_name as cust_nation,
                        year(l_shipdate) as l_year,
                        l_extendedprice * (1 - l_discount) as volume
                from
                        supplier,
                        lineitem,
                        orders,
                        customer,
                        nation n1,
                        nation n2
                where
                        s_suppkey = l_suppkey
                        and o_orderkey = l_orderkey
                        and c_custkey = o_custkey
                        and s_nationkey = n1.n_nationkey
                        and c_nationkey = n2.n_nationkey
                        and (
                                (n1.n_name = 'KENYA' and n2.n_name = 'PERU')
                                or (n1.n_name = 'PERU' and n2.n_name = 'KENYA')
                        )
                        and l_shipdate between cast('1995-01-01' as timestamp) and cast('1996-12-31' as timestamp)
        ) as shipping
group by
        supp_nation,
        cust_nation,
        l_year
order by
        supp_nation,
        cust_nation,
        l_year,,)
Time :4.703 ] 

 
18.949 [ Query :Query(select
        o_year,
        sum(case
                when nation = 'PERU' then volume
                else 0
        end) / sum(volume) as mkt_share
from
        (
                select
                        year(o_orderdate) as o_year,
                        l_extendedprice * (1 - l_discount) as volume,
                        n2.n_name as nation
                from
                        part,
                        supplier,
                        lineitem,
                        orders,
                        customer,
                        nation n1,
                        nation n2,
                        region
                where
                        p_partkey = l_partkey
                        and s_suppkey = l_suppkey
                        and l_orderkey = o_orderkey
                        and o_custkey = c_custkey
                        and c_nationkey = n1.n_nationkey
                        and n1.n_regionkey = r_regionkey
                        and r_name = 'AMERICA'
                        and s_nationkey = n2.n_nationkey
                        and o_orderdate between cast('1995-01-01' as timestamp) and  cast('1996-12-31' as timestamp)
                        and p_type = 'ECONOMY BURNISHED NICKEL'
        ) as all_nations
group by
        o_year
order by
        o_year,,)
Time :18.949 ] 

 
6.185 [ Query :Query(select
        c_custkey,
        c_name,
        sum(l_extendedprice * (1 - l_discount)) as revenue,
        c_acctbal,
        n_name,
        c_address,
        c_phone,
        c_comment
from
        customer,
        orders,
        lineitem,
        nation
where
        c_custkey = o_custkey
        and l_orderkey = o_orderkey
        and o_orderdate >= cast('1993-07-01' as timestamp)
        and o_orderdate < cast('1993-10-01' as timestamp)
        and l_returnflag = 'R'
        and c_nationkey = n_nationkey
group by
        c_custkey,
        c_name,
        c_acctbal,
        c_phone,
        n_name,
        c_address,
        c_comment
order by
        revenue desc
limit 20,,)
Time :6.185 ] 

 
3.432 [ Query :Query(select
        l_shipmode,
        sum(case
                when o_orderpriority = '1-URGENT'
                        or o_orderpriority = '2-HIGH'
                        then 1
                else 0
        end) as high_line_count,
        sum(case
                when o_orderpriority <> '1-URGENT'
                        and o_orderpriority <> '2-HIGH'
                        then 1
                else 0
        end) as low_line_count
from
        orders,
        lineitem
where
        o_orderkey = l_orderkey
        and l_shipmode in ('REG AIR', 'MAIL')
        and l_commitdate < l_receiptdate
        and l_shipdate < l_commitdate
        and l_receiptdate >= cast('1995-01-01' as timestamp) 
        and l_receiptdate < cast('1996-01-01' as timestamp) 
group by
        l_shipmode
order by
        l_shipmode,,)
Time :3.432 ] 

 
8.145 [ Query :Query(select
        c_count,
        count(*) as custdist
from
        (
                select
                        c_custkey,
                        count(o_orderkey) as c_count
                from
                        customer left outer join orders on
                                c_custkey = o_custkey
                                and o_comment not like '%unusual%accounts%'
                group by
                        c_custkey
        ) c_orders
group by
        c_count
order by
        custdist desc,
        c_count desc,,)
Time :8.145 ] 

 
1.052 [ Query :Query(select
        100.00 * sum(case
                when p_type like 'PROMO%'
                        then l_extendedprice * (1 - l_discount)
                else 0
        end) / sum(l_extendedprice * (1 - l_discount)) as promo_revenue
from
        lineitem,
        part
where
        l_partkey = p_partkey
        and l_shipdate >= cast('1995-08-01' as timestamp) 
        and l_shipdate < cast('1995-09-01' as timestamp),,)
Time :1.052 ] 

 
5.082 [ Query :Query(select
        p_brand,
        p_type,
        p_size,
        count(distinct ps_suppkey) as supplier_cnt
from
        partsupp,
        part
where
        p_partkey = ps_partkey
        and p_brand <> 'Brand#34'
        and p_type not like 'ECONOMY BRUSHED%'
        and p_size in (22, 14, 27, 49, 21, 33, 35, 28)
        and partsupp.ps_suppkey not in (
                select
                        s_suppkey
                from
                        supplier
                where
                        s_comment like '%Customer%Complaints%'
        )
group by
        p_brand,
        p_type,
        p_size
order by
        supplier_cnt desc,
        p_brand,
        p_type,
        p_size,,)
Time :5.082 ] 

 
0.949 [ Query :Query(with q17_part as (
  select p_partkey from part where  
  p_brand = 'Brand#23'
  and p_container = 'MED BOX'
),
q17_avg as (
  select l_partkey as t_partkey, 0.2 * avg(l_quantity) as t_avg_quantity
  from lineitem 
  where l_partkey IN (select p_partkey from q17_part)
  group by l_partkey
),
q17_price as (
  select
  l_quantity,
  l_partkey,
  l_extendedprice
  from
  lineitem
  where
  l_partkey IN (select p_partkey from q17_part)
)
select cast(sum(l_extendedprice) / 7.0 as decimal(32,2)) as avg_yearly
from q17_avg, q17_price
where 
t_partkey = l_partkey and l_quantity < t_avg_quantity,,)
Time :0.949 ] 

 
2.771 [ Query :Query(-- explain formatted 
with tmp1 as (
    select p_partkey from part where p_name like 'forest%'
),
tmp2 as (
    select s_name, s_address, s_suppkey
    from supplier, nation
    where s_nationkey = n_nationkey
    and n_name = 'CANADA'
),
tmp3 as (
    select l_partkey, 0.5 * sum(l_quantity) as sum_quantity, l_suppkey
    from lineitem, tmp2
    where l_shipdate >= cast('1994-01-01' as timestamp) and l_shipdate <= cast('1995-01-01' as timestamp)
    and l_suppkey = s_suppkey 
    group by l_partkey, l_suppkey
),
tmp4 as (
    select ps_partkey, ps_suppkey, ps_availqty
    from partsupp 
    where ps_partkey IN (select p_partkey from tmp1)
),
tmp5 as (
select
    ps_suppkey
from
    tmp4, tmp3
where
    ps_partkey = l_partkey
    and ps_suppkey = l_suppkey
    and ps_availqty > sum_quantity
)
select
    s_name,
    s_address
from
    supplier
where
    s_suppkey IN (select ps_suppkey from tmp5)
order by s_name,,)
Time :2.771 ] 

 
7.749 [ Query :Query(select
        l_returnflag,
        l_linestatus,
        sum(l_quantity) as sum_qty,
        sum(l_extendedprice) as sum_base_price,
        sum(l_extendedprice * (1 - l_discount)) as sum_disc_price,
        sum(l_extendedprice * (1 - l_discount) * (1 + l_tax)) as sum_charge,
        avg(l_quantity) as avg_qty,
        avg(l_extendedprice) as avg_price,
        avg(l_discount) as avg_disc,
        count(*) as count_order
from
        lineitem
where
        l_shipdate <= cast('1998-09-16' as timestamp)
group by
        l_returnflag,
        l_linestatus
order by
        l_returnflag,
        l_linestatus,,)
Time :7.749 ] 

 
8.262 [ Query :Query(select
        l_orderkey,
        sum(l_extendedprice * (1 - l_discount)) as revenue,
        o_orderdate,
        o_shippriority
from
        customer,
        orders,
        lineitem
where
        c_mktsegment = 'BUILDING'
        and c_custkey = o_custkey
        and l_orderkey = o_orderkey
        and o_orderdate <  cast('1995-03-22' as timestamp)
        and l_shipdate > cast('1995-03-22' as timestamp)
group by
        l_orderkey,
        o_orderdate,
        o_shippriority
order by
        revenue desc,
        o_orderdate
limit 10,,)
Time :8.262 ] 

 
4.5 [ Query :Query(select
        o_orderpriority,
        count(*) as order_count
from
        orders as o
where
        o_orderdate >= cast('1996-05-01' as timestamp)
        and o_orderdate < cast('1996-08-01' as timestamp)
        and exists (
                select
                        *
                from
                        lineitem
                where
                        l_orderkey = o.o_orderkey
                        and l_commitdate < l_receiptdate
        )
group by
        o_orderpriority
order by
        o_orderpriority,,)
Time :4.5 ] 

 
5.252 [ Query :Query(select
        n_name,
        sum(l_extendedprice * (1 - l_discount)) as revenue
from
        customer,
        orders,
        lineitem,
        supplier,
        nation,
        region
where
        c_custkey = o_custkey
        and l_orderkey = o_orderkey
        and l_suppkey = s_suppkey
        and c_nationkey = s_nationkey
        and s_nationkey = n_nationkey
        and n_regionkey = r_regionkey
        and r_name = 'AFRICA'
        and o_orderdate >= cast('1993-01-01' as timestamp)
        and o_orderdate < cast('1994-01-01' as timestamp)
group by
        n_name
order by
        revenue desc,,)
Time :5.252 ] 

 
3.776 [ Query :Query(select
        o_orderpriority,
        count(*) as order_count
from
        orders as o
where
        o_orderdate >= cast('1996-05-01' as timestamp)
        and o_orderdate < cast('1996-08-01' as timestamp)
        and exists (
                select
                        *
                from
                        lineitem
                where
                        l_orderkey = o.o_orderkey
                        and l_commitdate < l_receiptdate
        )
group by
        o_orderpriority
order by
        o_orderpriority,,)
Time :3.776 ] 

 
4.756 [ Query :Query(select
        n_name,
        sum(l_extendedprice * (1 - l_discount)) as revenue
from
        customer,
        orders,
        lineitem,
        supplier,
        nation,
        region
where
        c_custkey = o_custkey
        and l_orderkey = o_orderkey
        and l_suppkey = s_suppkey
        and c_nationkey = s_nationkey
        and s_nationkey = n_nationkey
        and n_regionkey = r_regionkey
        and r_name = 'AFRICA'
        and o_orderdate >= cast('1993-01-01' as timestamp)
        and o_orderdate < cast('1994-01-01' as timestamp) 
group by
        n_name
order by
        revenue desc,,)
Time :4.756 ] 

 
0.387 [ Query :Query(select
        sum(l_extendedprice * l_discount) as revenue
from
        lineitem
where
        l_shipdate >= cast('1993-01-01' as timestamp)
        and l_shipdate < cast('1994-01-01' as timestamp) 
        and l_discount between 0.06 - 0.01 and 0.06 + 0.01
        and l_quantity < 25,,)
Time :0.387 ] 

 
4.204 [ Query :Query(select
        supp_nation,
        cust_nation,
        l_year,
        sum(volume) as revenue
from
        (
                select
                        n1.n_name as supp_nation,
                        n2.n_name as cust_nation,
                        year(l_shipdate) as l_year,
                        l_extendedprice * (1 - l_discount) as volume
                from
                        supplier,
                        lineitem,
                        orders,
                        customer,
                        nation n1,
                        nation n2
                where
                        s_suppkey = l_suppkey
                        and o_orderkey = l_orderkey
                        and c_custkey = o_custkey
                        and s_nationkey = n1.n_nationkey
                        and c_nationkey = n2.n_nationkey
                        and (
                                (n1.n_name = 'KENYA' and n2.n_name = 'PERU')
                                or (n1.n_name = 'PERU' and n2.n_name = 'KENYA')
                        )
                        and l_shipdate between cast('1995-01-01' as timestamp) and cast('1996-12-31' as timestamp)
        ) as shipping
group by
        supp_nation,
        cust_nation,
        l_year
order by
        supp_nation,
        cust_nation,
        l_year,,)
Time :4.204 ] 

 
17.735 [ Query :Query(select
        o_year,
        sum(case
                when nation = 'PERU' then volume
                else 0
        end) / sum(volume) as mkt_share
from
        (
                select
                        year(o_orderdate) as o_year,
                        l_extendedprice * (1 - l_discount) as volume,
                        n2.n_name as nation
                from
                        part,
                        supplier,
                        lineitem,
                        orders,
                        customer,
                        nation n1,
                        nation n2,
                        region
                where
                        p_partkey = l_partkey
                        and s_suppkey = l_suppkey
                        and l_orderkey = o_orderkey
                        and o_custkey = c_custkey
                        and c_nationkey = n1.n_nationkey
                        and n1.n_regionkey = r_regionkey
                        and r_name = 'AMERICA'
                        and s_nationkey = n2.n_nationkey
                        and o_orderdate between cast('1995-01-01' as timestamp) and  cast('1996-12-31' as timestamp)
                        and p_type = 'ECONOMY BURNISHED NICKEL'
        ) as all_nations
group by
        o_year
order by
        o_year,,)
Time :17.735 ] 

 
4.977 [ Query :Query(select
        c_custkey,
        c_name,
        sum(l_extendedprice * (1 - l_discount)) as revenue,
        c_acctbal,
        n_name,
        c_address,
        c_phone,
        c_comment
from
        customer,
        orders,
        lineitem,
        nation
where
        c_custkey = o_custkey
        and l_orderkey = o_orderkey
        and o_orderdate >= cast('1993-07-01' as timestamp)
        and o_orderdate < cast('1993-10-01' as timestamp)
        and l_returnflag = 'R'
        and c_nationkey = n_nationkey
group by
        c_custkey,
        c_name,
        c_acctbal,
        c_phone,
        n_name,
        c_address,
        c_comment
order by
        revenue desc
limit 20,,)
Time :4.977 ] 

 
3.072 [ Query :Query(select
        l_shipmode,
        sum(case
                when o_orderpriority = '1-URGENT'
                        or o_orderpriority = '2-HIGH'
                        then 1
                else 0
        end) as high_line_count,
        sum(case
                when o_orderpriority <> '1-URGENT'
                        and o_orderpriority <> '2-HIGH'
                        then 1
                else 0
        end) as low_line_count
from
        orders,
        lineitem
where
        o_orderkey = l_orderkey
        and l_shipmode in ('REG AIR', 'MAIL')
        and l_commitdate < l_receiptdate
        and l_shipdate < l_commitdate
        and l_receiptdate >= cast('1995-01-01' as timestamp) 
        and l_receiptdate < cast('1996-01-01' as timestamp) 
group by
        l_shipmode
order by
        l_shipmode,,)
Time :3.072 ] 

 
7.256 [ Query :Query(select
        c_count,
        count(*) as custdist
from
        (
                select
                        c_custkey,
                        count(o_orderkey) as c_count
                from
                        customer left outer join orders on
                                c_custkey = o_custkey
                                and o_comment not like '%unusual%accounts%'
                group by
                        c_custkey
        ) c_orders
group by
        c_count
order by
        custdist desc,
        c_count desc,,)
Time :7.256 ] 

 
0.876 [ Query :Query(select
        100.00 * sum(case
                when p_type like 'PROMO%'
                        then l_extendedprice * (1 - l_discount)
                else 0
        end) / sum(l_extendedprice * (1 - l_discount)) as promo_revenue
from
        lineitem,
        part
where
        l_partkey = p_partkey
        and l_shipdate >= cast('1995-08-01' as timestamp) 
        and l_shipdate < cast('1995-09-01' as timestamp),,)
Time :0.876 ] 

 
3.164 [ Query :Query(select
        p_brand,
        p_type,
        p_size,
        count(distinct ps_suppkey) as supplier_cnt
from
        partsupp,
        part
where
        p_partkey = ps_partkey
        and p_brand <> 'Brand#34'
        and p_type not like 'ECONOMY BRUSHED%'
        and p_size in (22, 14, 27, 49, 21, 33, 35, 28)
        and partsupp.ps_suppkey not in (
                select
                        s_suppkey
                from
                        supplier
                where
                        s_comment like '%Customer%Complaints%'
        )
group by
        p_brand,
        p_type,
        p_size
order by
        supplier_cnt desc,
        p_brand,
        p_type,
        p_size,,)
Time :3.164 ] 

 
0.419 [ Query :Query(with q17_part as (
  select p_partkey from part where  
  p_brand = 'Brand#23'
  and p_container = 'MED BOX'
),
q17_avg as (
  select l_partkey as t_partkey, 0.2 * avg(l_quantity) as t_avg_quantity
  from lineitem 
  where l_partkey IN (select p_partkey from q17_part)
  group by l_partkey
),
q17_price as (
  select
  l_quantity,
  l_partkey,
  l_extendedprice
  from
  lineitem
  where
  l_partkey IN (select p_partkey from q17_part)
)
select cast(sum(l_extendedprice) / 7.0 as decimal(32,2)) as avg_yearly
from q17_avg, q17_price
where 
t_partkey = l_partkey and l_quantity < t_avg_quantity,,)
Time :0.419 ] 

 
3.775 [ Query :Query(-- explain formatted 
with tmp1 as (
    select p_partkey from part where p_name like 'forest%'
),
tmp2 as (
    select s_name, s_address, s_suppkey
    from supplier, nation
    where s_nationkey = n_nationkey
    and n_name = 'CANADA'
),
tmp3 as (
    select l_partkey, 0.5 * sum(l_quantity) as sum_quantity, l_suppkey
    from lineitem, tmp2
    where l_shipdate >= cast('1994-01-01' as timestamp) and l_shipdate <= cast('1995-01-01' as timestamp)
    and l_suppkey = s_suppkey 
    group by l_partkey, l_suppkey
),
tmp4 as (
    select ps_partkey, ps_suppkey, ps_availqty
    from partsupp 
    where ps_partkey IN (select p_partkey from tmp1)
),
tmp5 as (
select
    ps_suppkey
from
    tmp4, tmp3
where
    ps_partkey = l_partkey
    and ps_suppkey = l_suppkey
    and ps_availqty > sum_quantity
)
select
    s_name,
    s_address
from
    supplier
where
    s_suppkey IN (select ps_suppkey from tmp5)
order by s_name,,)
Time :3.775 ] 

 
4.76 [ Query :Query(select
        l_returnflag,
        l_linestatus,
        sum(l_quantity) as sum_qty,
        sum(l_extendedprice) as sum_base_price,
        sum(l_extendedprice * (1 - l_discount)) as sum_disc_price,
        sum(l_extendedprice * (1 - l_discount) * (1 + l_tax)) as sum_charge,
        avg(l_quantity) as avg_qty,
        avg(l_extendedprice) as avg_price,
        avg(l_discount) as avg_disc,
        count(*) as count_order
from
        lineitem
where
        l_shipdate <= cast('1998-09-16' as timestamp)
group by
        l_returnflag,
        l_linestatus
order by
        l_returnflag,
        l_linestatus,,)
Time :4.76 ] 

 
7.229 [ Query :Query(select
        l_orderkey,
        sum(l_extendedprice * (1 - l_discount)) as revenue,
        o_orderdate,
        o_shippriority
from
        customer,
        orders,
        lineitem
where
        c_mktsegment = 'BUILDING'
        and c_custkey = o_custkey
        and l_orderkey = o_orderkey
        and o_orderdate <  cast('1995-03-22' as timestamp)
        and l_shipdate > cast('1995-03-22' as timestamp)
group by
        l_orderkey,
        o_orderdate,
        o_shippriority
order by
        revenue desc,
        o_orderdate
limit 10,,)
Time :7.229 ] 

 
4.37 [ Query :Query(select
        o_orderpriority,
        count(*) as order_count
from
        orders as o
where
        o_orderdate >= cast('1996-05-01' as timestamp)
        and o_orderdate < cast('1996-08-01' as timestamp)
        and exists (
                select
                        *
                from
                        lineitem
                where
                        l_orderkey = o.o_orderkey
                        and l_commitdate < l_receiptdate
        )
group by
        o_orderpriority
order by
        o_orderpriority,,)
Time :4.37 ] 

 
5.282 [ Query :Query(select
        n_name,
        sum(l_extendedprice * (1 - l_discount)) as revenue
from
        customer,
        orders,
        lineitem,
        supplier,
        nation,
        region
where
        c_custkey = o_custkey
        and l_orderkey = o_orderkey
        and l_suppkey = s_suppkey
        and c_nationkey = s_nationkey
        and s_nationkey = n_nationkey
        and n_regionkey = r_regionkey
        and r_name = 'AFRICA'
        and o_orderdate >= cast('1993-01-01' as timestamp)
        and o_orderdate < cast('1994-01-01' as timestamp)
group by
        n_name
order by
        revenue desc,,)
Time :5.282 ] 

 
3.96 [ Query :Query(select
        o_orderpriority,
        count(*) as order_count
from
        orders as o
where
        o_orderdate >= cast('1996-05-01' as timestamp)
        and o_orderdate < cast('1996-08-01' as timestamp)
        and exists (
                select
                        *
                from
                        lineitem
                where
                        l_orderkey = o.o_orderkey
                        and l_commitdate < l_receiptdate
        )
group by
        o_orderpriority
order by
        o_orderpriority,,)
Time :3.96 ] 

 
4.761 [ Query :Query(select
        n_name,
        sum(l_extendedprice * (1 - l_discount)) as revenue
from
        customer,
        orders,
        lineitem,
        supplier,
        nation,
        region
where
        c_custkey = o_custkey
        and l_orderkey = o_orderkey
        and l_suppkey = s_suppkey
        and c_nationkey = s_nationkey
        and s_nationkey = n_nationkey
        and n_regionkey = r_regionkey
        and r_name = 'AFRICA'
        and o_orderdate >= cast('1993-01-01' as timestamp)
        and o_orderdate < cast('1994-01-01' as timestamp) 
group by
        n_name
order by
        revenue desc,,)
Time :4.761 ] 

 
0.316 [ Query :Query(select
        sum(l_extendedprice * l_discount) as revenue
from
        lineitem
where
        l_shipdate >= cast('1993-01-01' as timestamp)
        and l_shipdate < cast('1994-01-01' as timestamp) 
        and l_discount between 0.06 - 0.01 and 0.06 + 0.01
        and l_quantity < 25,,)
Time :0.316 ] 

 
6.101 [ Query :Query(select
        supp_nation,
        cust_nation,
        l_year,
        sum(volume) as revenue
from
        (
                select
                        n1.n_name as supp_nation,
                        n2.n_name as cust_nation,
                        year(l_shipdate) as l_year,
                        l_extendedprice * (1 - l_discount) as volume
                from
                        supplier,
                        lineitem,
                        orders,
                        customer,
                        nation n1,
                        nation n2
                where
                        s_suppkey = l_suppkey
                        and o_orderkey = l_orderkey
                        and c_custkey = o_custkey
                        and s_nationkey = n1.n_nationkey
                        and c_nationkey = n2.n_nationkey
                        and (
                                (n1.n_name = 'KENYA' and n2.n_name = 'PERU')
                                or (n1.n_name = 'PERU' and n2.n_name = 'KENYA')
                        )
                        and l_shipdate between cast('1995-01-01' as timestamp) and cast('1996-12-31' as timestamp)
        ) as shipping
group by
        supp_nation,
        cust_nation,
        l_year
order by
        supp_nation,
        cust_nation,
        l_year,,)
Time :6.101 ] 

 
18.997 [ Query :Query(select
        o_year,
        sum(case
                when nation = 'PERU' then volume
                else 0
        end) / sum(volume) as mkt_share
from
        (
                select
                        year(o_orderdate) as o_year,
                        l_extendedprice * (1 - l_discount) as volume,
                        n2.n_name as nation
                from
                        part,
                        supplier,
                        lineitem,
                        orders,
                        customer,
                        nation n1,
                        nation n2,
                        region
                where
                        p_partkey = l_partkey
                        and s_suppkey = l_suppkey
                        and l_orderkey = o_orderkey
                        and o_custkey = c_custkey
                        and c_nationkey = n1.n_nationkey
                        and n1.n_regionkey = r_regionkey
                        and r_name = 'AMERICA'
                        and s_nationkey = n2.n_nationkey
                        and o_orderdate between cast('1995-01-01' as timestamp) and  cast('1996-12-31' as timestamp)
                        and p_type = 'ECONOMY BURNISHED NICKEL'
        ) as all_nations
group by
        o_year
order by
        o_year,,)
Time :18.997 ] 

 
4.896 [ Query :Query(select
        c_custkey,
        c_name,
        sum(l_extendedprice * (1 - l_discount)) as revenue,
        c_acctbal,
        n_name,
        c_address,
        c_phone,
        c_comment
from
        customer,
        orders,
        lineitem,
        nation
where
        c_custkey = o_custkey
        and l_orderkey = o_orderkey
        and o_orderdate >= cast('1993-07-01' as timestamp)
        and o_orderdate < cast('1993-10-01' as timestamp)
        and l_returnflag = 'R'
        and c_nationkey = n_nationkey
group by
        c_custkey,
        c_name,
        c_acctbal,
        c_phone,
        n_name,
        c_address,
        c_comment
order by
        revenue desc
limit 20,,)
Time :4.896 ] 

 
3.857 [ Query :Query(select
        l_shipmode,
        sum(case
                when o_orderpriority = '1-URGENT'
                        or o_orderpriority = '2-HIGH'
                        then 1
                else 0
        end) as high_line_count,
        sum(case
                when o_orderpriority <> '1-URGENT'
                        and o_orderpriority <> '2-HIGH'
                        then 1
                else 0
        end) as low_line_count
from
        orders,
        lineitem
where
        o_orderkey = l_orderkey
        and l_shipmode in ('REG AIR', 'MAIL')
        and l_commitdate < l_receiptdate
        and l_shipdate < l_commitdate
        and l_receiptdate >= cast('1995-01-01' as timestamp) 
        and l_receiptdate < cast('1996-01-01' as timestamp) 
group by
        l_shipmode
order by
        l_shipmode,,)
Time :3.857 ] 

 
7.824 [ Query :Query(select
        c_count,
        count(*) as custdist
from
        (
                select
                        c_custkey,
                        count(o_orderkey) as c_count
                from
                        customer left outer join orders on
                                c_custkey = o_custkey
                                and o_comment not like '%unusual%accounts%'
                group by
                        c_custkey
        ) c_orders
group by
        c_count
order by
        custdist desc,
        c_count desc,,)
Time :7.824 ] 

 
0.921 [ Query :Query(select
        100.00 * sum(case
                when p_type like 'PROMO%'
                        then l_extendedprice * (1 - l_discount)
                else 0
        end) / sum(l_extendedprice * (1 - l_discount)) as promo_revenue
from
        lineitem,
        part
where
        l_partkey = p_partkey
        and l_shipdate >= cast('1995-08-01' as timestamp) 
        and l_shipdate < cast('1995-09-01' as timestamp),,)
Time :0.921 ] 

 
3.728 [ Query :Query(select
        p_brand,
        p_type,
        p_size,
        count(distinct ps_suppkey) as supplier_cnt
from
        partsupp,
        part
where
        p_partkey = ps_partkey
        and p_brand <> 'Brand#34'
        and p_type not like 'ECONOMY BRUSHED%'
        and p_size in (22, 14, 27, 49, 21, 33, 35, 28)
        and partsupp.ps_suppkey not in (
                select
                        s_suppkey
                from
                        supplier
                where
                        s_comment like '%Customer%Complaints%'
        )
group by
        p_brand,
        p_type,
        p_size
order by
        supplier_cnt desc,
        p_brand,
        p_type,
        p_size,,)
Time :3.728 ] 

 
0.494 [ Query :Query(with q17_part as (
  select p_partkey from part where  
  p_brand = 'Brand#23'
  and p_container = 'MED BOX'
),
q17_avg as (
  select l_partkey as t_partkey, 0.2 * avg(l_quantity) as t_avg_quantity
  from lineitem 
  where l_partkey IN (select p_partkey from q17_part)
  group by l_partkey
),
q17_price as (
  select
  l_quantity,
  l_partkey,
  l_extendedprice
  from
  lineitem
  where
  l_partkey IN (select p_partkey from q17_part)
)
select cast(sum(l_extendedprice) / 7.0 as decimal(32,2)) as avg_yearly
from q17_avg, q17_price
where 
t_partkey = l_partkey and l_quantity < t_avg_quantity,,)
Time :0.494 ] 

 
3.217 [ Query :Query(-- explain formatted 
with tmp1 as (
    select p_partkey from part where p_name like 'forest%'
),
tmp2 as (
    select s_name, s_address, s_suppkey
    from supplier, nation
    where s_nationkey = n_nationkey
    and n_name = 'CANADA'
),
tmp3 as (
    select l_partkey, 0.5 * sum(l_quantity) as sum_quantity, l_suppkey
    from lineitem, tmp2
    where l_shipdate >= cast('1994-01-01' as timestamp) and l_shipdate <= cast('1995-01-01' as timestamp)
    and l_suppkey = s_suppkey 
    group by l_partkey, l_suppkey
),
tmp4 as (
    select ps_partkey, ps_suppkey, ps_availqty
    from partsupp 
    where ps_partkey IN (select p_partkey from tmp1)
),
tmp5 as (
select
    ps_suppkey
from
    tmp4, tmp3
where
    ps_partkey = l_partkey
    and ps_suppkey = l_suppkey
    and ps_availqty > sum_quantity
)
select
    s_name,
    s_address
from
    supplier
where
    s_suppkey IN (select ps_suppkey from tmp5)
order by s_name,,)
Time :3.217 ] 

 
4.125 [ Query :Query(select
        l_returnflag,
        l_linestatus,
        sum(l_quantity) as sum_qty,
        sum(l_extendedprice) as sum_base_price,
        sum(l_extendedprice * (1 - l_discount)) as sum_disc_price,
        sum(l_extendedprice * (1 - l_discount) * (1 + l_tax)) as sum_charge,
        avg(l_quantity) as avg_qty,
        avg(l_extendedprice) as avg_price,
        avg(l_discount) as avg_disc,
        count(*) as count_order
from
        lineitem
where
        l_shipdate <= cast('1998-09-16' as timestamp)
group by
        l_returnflag,
        l_linestatus
order by
        l_returnflag,
        l_linestatus,,)
Time :4.125 ] 

 
4.207 [ Query :Query(select
        l_returnflag,
        l_linestatus,
        sum(l_quantity) as sum_qty,
        sum(l_extendedprice) as sum_base_price,
        sum(l_extendedprice * (1 - l_discount)) as sum_disc_price,
        sum(l_extendedprice * (1 - l_discount) * (1 + l_tax)) as sum_charge,
        avg(l_quantity) as avg_qty,
        avg(l_extendedprice) as avg_price,
        avg(l_discount) as avg_disc,
        count(*) as count_order
from
        lineitem
where
        l_shipdate <= cast('1998-09-16' as timestamp)
group by
        l_returnflag,
        l_linestatus
order by
        l_returnflag,
        l_linestatus,,)
Time :4.207 ] 

 
4.989 [ Query :Query(select
        l_returnflag,
        l_linestatus,
        sum(l_quantity) as sum_qty,
        sum(l_extendedprice) as sum_base_price,
        sum(l_extendedprice * (1 - l_discount)) as sum_disc_price,
        sum(l_extendedprice * (1 - l_discount) * (1 + l_tax)) as sum_charge,
        avg(l_quantity) as avg_qty,
        avg(l_extendedprice) as avg_price,
        avg(l_discount) as avg_disc,
        count(*) as count_order
from
        lineitem
where
        l_shipdate <= cast('1998-09-16' as timestamp)
group by
        l_returnflag,
        l_linestatus
order by
        l_returnflag,
        l_linestatus,,)
Time :4.989 ] 

 
7.989 [ Query :Query(select
        l_orderkey,
        sum(l_extendedprice * (1 - l_discount)) as revenue,
        o_orderdate,
        o_shippriority
from
        customer,
        orders,
        lineitem
where
        c_mktsegment = 'BUILDING'
        and c_custkey = o_custkey
        and l_orderkey = o_orderkey
        and o_orderdate <  cast('1995-03-22' as timestamp)
        and l_shipdate > cast('1995-03-22' as timestamp)
group by
        l_orderkey,
        o_orderdate,
        o_shippriority
order by
        revenue desc,
        o_orderdate
limit 10,,)
Time :7.989 ] 

 
5.005 [ Query :Query(select
        o_orderpriority,
        count(*) as order_count
from
        orders as o
where
        o_orderdate >= cast('1996-05-01' as timestamp)
        and o_orderdate < cast('1996-08-01' as timestamp)
        and exists (
                select
                        *
                from
                        lineitem
                where
                        l_orderkey = o.o_orderkey
                        and l_commitdate < l_receiptdate
        )
group by
        o_orderpriority
order by
        o_orderpriority,,)
Time :5.005 ] 

 
5.858 [ Query :Query(select
        n_name,
        sum(l_extendedprice * (1 - l_discount)) as revenue
from
        customer,
        orders,
        lineitem,
        supplier,
        nation,
        region
where
        c_custkey = o_custkey
        and l_orderkey = o_orderkey
        and l_suppkey = s_suppkey
        and c_nationkey = s_nationkey
        and s_nationkey = n_nationkey
        and n_regionkey = r_regionkey
        and r_name = 'AFRICA'
        and o_orderdate >= cast('1993-01-01' as timestamp)
        and o_orderdate < cast('1994-01-01' as timestamp)
group by
        n_name
order by
        revenue desc,,)
Time :5.858 ] 

 
3.576 [ Query :Query(select
        o_orderpriority,
        count(*) as order_count
from
        orders as o
where
        o_orderdate >= cast('1996-05-01' as timestamp)
        and o_orderdate < cast('1996-08-01' as timestamp)
        and exists (
                select
                        *
                from
                        lineitem
                where
                        l_orderkey = o.o_orderkey
                        and l_commitdate < l_receiptdate
        )
group by
        o_orderpriority
order by
        o_orderpriority,,)
Time :3.576 ] 

 
4.778 [ Query :Query(select
        n_name,
        sum(l_extendedprice * (1 - l_discount)) as revenue
from
        customer,
        orders,
        lineitem,
        supplier,
        nation,
        region
where
        c_custkey = o_custkey
        and l_orderkey = o_orderkey
        and l_suppkey = s_suppkey
        and c_nationkey = s_nationkey
        and s_nationkey = n_nationkey
        and n_regionkey = r_regionkey
        and r_name = 'AFRICA'
        and o_orderdate >= cast('1993-01-01' as timestamp)
        and o_orderdate < cast('1994-01-01' as timestamp) 
group by
        n_name
order by
        revenue desc,,)
Time :4.778 ] 

 
0.29 [ Query :Query(select
        sum(l_extendedprice * l_discount) as revenue
from
        lineitem
where
        l_shipdate >= cast('1993-01-01' as timestamp)
        and l_shipdate < cast('1994-01-01' as timestamp) 
        and l_discount between 0.06 - 0.01 and 0.06 + 0.01
        and l_quantity < 25,,)
Time :0.29 ] 

 
5.306 [ Query :Query(select
        supp_nation,
        cust_nation,
        l_year,
        sum(volume) as revenue
from
        (
                select
                        n1.n_name as supp_nation,
                        n2.n_name as cust_nation,
                        year(l_shipdate) as l_year,
                        l_extendedprice * (1 - l_discount) as volume
                from
                        supplier,
                        lineitem,
                        orders,
                        customer,
                        nation n1,
                        nation n2
                where
                        s_suppkey = l_suppkey
                        and o_orderkey = l_orderkey
                        and c_custkey = o_custkey
                        and s_nationkey = n1.n_nationkey
                        and c_nationkey = n2.n_nationkey
                        and (
                                (n1.n_name = 'KENYA' and n2.n_name = 'PERU')
                                or (n1.n_name = 'PERU' and n2.n_name = 'KENYA')
                        )
                        and l_shipdate between cast('1995-01-01' as timestamp) and cast('1996-12-31' as timestamp)
        ) as shipping
group by
        supp_nation,
        cust_nation,
        l_year
order by
        supp_nation,
        cust_nation,
        l_year,,)
Time :5.306 ] 

 
21.347 [ Query :Query(select
        o_year,
        sum(case
                when nation = 'PERU' then volume
                else 0
        end) / sum(volume) as mkt_share
from
        (
                select
                        year(o_orderdate) as o_year,
                        l_extendedprice * (1 - l_discount) as volume,
                        n2.n_name as nation
                from
                        part,
                        supplier,
                        lineitem,
                        orders,
                        customer,
                        nation n1,
                        nation n2,
                        region
                where
                        p_partkey = l_partkey
                        and s_suppkey = l_suppkey
                        and l_orderkey = o_orderkey
                        and o_custkey = c_custkey
                        and c_nationkey = n1.n_nationkey
                        and n1.n_regionkey = r_regionkey
                        and r_name = 'AMERICA'
                        and s_nationkey = n2.n_nationkey
                        and o_orderdate between cast('1995-01-01' as timestamp) and  cast('1996-12-31' as timestamp)
                        and p_type = 'ECONOMY BURNISHED NICKEL'
        ) as all_nations
group by
        o_year
order by
        o_year,,)
Time :21.347 ] 

 
5.877 [ Query :Query(select
        c_custkey,
        c_name,
        sum(l_extendedprice * (1 - l_discount)) as revenue,
        c_acctbal,
        n_name,
        c_address,
        c_phone,
        c_comment
from
        customer,
        orders,
        lineitem,
        nation
where
        c_custkey = o_custkey
        and l_orderkey = o_orderkey
        and o_orderdate >= cast('1993-07-01' as timestamp)
        and o_orderdate < cast('1993-10-01' as timestamp)
        and l_returnflag = 'R'
        and c_nationkey = n_nationkey
group by
        c_custkey,
        c_name,
        c_acctbal,
        c_phone,
        n_name,
        c_address,
        c_comment
order by
        revenue desc
limit 20,,)
Time :5.877 ] 

 
4.197 [ Query :Query(select
        l_shipmode,
        sum(case
                when o_orderpriority = '1-URGENT'
                        or o_orderpriority = '2-HIGH'
                        then 1
                else 0
        end) as high_line_count,
        sum(case
                when o_orderpriority <> '1-URGENT'
                        and o_orderpriority <> '2-HIGH'
                        then 1
                else 0
        end) as low_line_count
from
        orders,
        lineitem
where
        o_orderkey = l_orderkey
        and l_shipmode in ('REG AIR', 'MAIL')
        and l_commitdate < l_receiptdate
        and l_shipdate < l_commitdate
        and l_receiptdate >= cast('1995-01-01' as timestamp) 
        and l_receiptdate < cast('1996-01-01' as timestamp) 
group by
        l_shipmode
order by
        l_shipmode,,)
Time :4.197 ] 

 
8.196 [ Query :Query(select
        c_count,
        count(*) as custdist
from
        (
                select
                        c_custkey,
                        count(o_orderkey) as c_count
                from
                        customer left outer join orders on
                                c_custkey = o_custkey
                                and o_comment not like '%unusual%accounts%'
                group by
                        c_custkey
        ) c_orders
group by
        c_count
order by
        custdist desc,
        c_count desc,,)
Time :8.196 ] 

 
0.838 [ Query :Query(select
        100.00 * sum(case
                when p_type like 'PROMO%'
                        then l_extendedprice * (1 - l_discount)
                else 0
        end) / sum(l_extendedprice * (1 - l_discount)) as promo_revenue
from
        lineitem,
        part
where
        l_partkey = p_partkey
        and l_shipdate >= cast('1995-08-01' as timestamp) 
        and l_shipdate < cast('1995-09-01' as timestamp),,)
Time :0.838 ] 

 
5.402 [ Query :Query(select
        p_brand,
        p_type,
        p_size,
        count(distinct ps_suppkey) as supplier_cnt
from
        partsupp,
        part
where
        p_partkey = ps_partkey
        and p_brand <> 'Brand#34'
        and p_type not like 'ECONOMY BRUSHED%'
        and p_size in (22, 14, 27, 49, 21, 33, 35, 28)
        and partsupp.ps_suppkey not in (
                select
                        s_suppkey
                from
                        supplier
                where
                        s_comment like '%Customer%Complaints%'
        )
group by
        p_brand,
        p_type,
        p_size
order by
        supplier_cnt desc,
        p_brand,
        p_type,
        p_size,,)
Time :5.402 ] 

 
0.757 [ Query :Query(with q17_part as (
  select p_partkey from part where  
  p_brand = 'Brand#23'
  and p_container = 'MED BOX'
),
q17_avg as (
  select l_partkey as t_partkey, 0.2 * avg(l_quantity) as t_avg_quantity
  from lineitem 
  where l_partkey IN (select p_partkey from q17_part)
  group by l_partkey
),
q17_price as (
  select
  l_quantity,
  l_partkey,
  l_extendedprice
  from
  lineitem
  where
  l_partkey IN (select p_partkey from q17_part)
)
select cast(sum(l_extendedprice) / 7.0 as decimal(32,2)) as avg_yearly
from q17_avg, q17_price
where 
t_partkey = l_partkey and l_quantity < t_avg_quantity,,)
Time :0.757 ] 

 
4.022 [ Query :Query(-- explain formatted 
with tmp1 as (
    select p_partkey from part where p_name like 'forest%'
),
tmp2 as (
    select s_name, s_address, s_suppkey
    from supplier, nation
    where s_nationkey = n_nationkey
    and n_name = 'CANADA'
),
tmp3 as (
    select l_partkey, 0.5 * sum(l_quantity) as sum_quantity, l_suppkey
    from lineitem, tmp2
    where l_shipdate >= cast('1994-01-01' as timestamp) and l_shipdate <= cast('1995-01-01' as timestamp)
    and l_suppkey = s_suppkey 
    group by l_partkey, l_suppkey
),
tmp4 as (
    select ps_partkey, ps_suppkey, ps_availqty
    from partsupp 
    where ps_partkey IN (select p_partkey from tmp1)
),
tmp5 as (
select
    ps_suppkey
from
    tmp4, tmp3
where
    ps_partkey = l_partkey
    and ps_suppkey = l_suppkey
    and ps_availqty > sum_quantity
)
select
    s_name,
    s_address
from
    supplier
where
    s_suppkey IN (select ps_suppkey from tmp5)
order by s_name,,)
Time :4.022 ] 

 
7.093
4.063
6.249
4.096
4.442
3.019
3.496
0.344
4.318
19.603
4.605
3.335
9.712
0.935
3.78
0.628
3.031
7.766
7.659
4.449
6.112
3.237
3.976
0.519
4.282
21.517
6.252
3.468
9.499
1.176
6.06
1.059
2.769
9.95
7.625
5.445
4.908
3.196
4.174
0.399
4.807
19.284
11.104
6.439
7.685
0.884
5.467
0.702
3.48
9.295
7.628
4.37
5.934
3.479
4.309
0.412
4.292
19.408
4.772
3.079
8.14
0.882
3.076
0.612
2.882
3.905
6.393
3.894
5.166
3.407
3.872
0.272
4.218
17.126
4.374
3.223
6.739
0.838
3.154
0.55
2.775
6.282
7.438
3.952
5.33
3.118
4.267
0.37
4.18
18.764
4.915
3.184
8.967
0.846
3.513
0.694
2.27
5.323
6.323
3.797
4.454
3.018
3.609
0.463
4.543
17.304
5.303
2.905
7.377
1.047
4.026
1.123
5.116
9.04
6.558
4.132
4.676
2.894
3.753
0.357
3.712
16.407
4.593
3.161
7.105
0.853
3.04
1.634
2.691
10.171
7.606
4.637
4.068
3.185
3.347
0.259
3.849
20.159
7.284
3.069
7.97
0.938
2.966
1.841
2.145
6.755
7.004
4.136
5.062
3.168
3.288
0.345
3.738
18.579
5.159
2.991
7.028
1.245
3.266
0.541
2.666
6.518
6.395
3.878
4.48
3.175
3.351
0.392
3.959
17.543
6.039
2.996
7.326
0.906
4.906
0.571
3.324
10.154
6.7
4.119
4.49
2.921
3.721
0.395
3.767
18.219
4.292
3.707
7.351
0.708
2.847
0.619
2.801
2.279
4.484
7.278
4.83
5.303
3.289
3.969
0.443
4.425
22.344
7.834
2.984
8.608
1.13
6.755
0.779
3.148
12.175 [ Query :Query(select
        l_returnflag,
        l_linestatus,
        sum(l_quantity) as sum_qty,
        sum(l_extendedprice) as sum_base_price,
        sum(l_extendedprice * (1 - l_discount)) as sum_disc_price,
        sum(l_extendedprice * (1 - l_discount) * (1 + l_tax)) as sum_charge,
        avg(l_quantity) as avg_qty,
        avg(l_extendedprice) as avg_price,
        avg(l_discount) as avg_disc,
        count(*) as count_order
from
        lineitem
where
        l_shipdate <= cast('1998-09-16' as timestamp)
group by
        l_returnflag,
        l_linestatus
order by
        l_returnflag,
        l_linestatus,,)
Time :12.175 ] 

 
7.505 [ Query :Query(select
        l_orderkey,
        sum(l_extendedprice * (1 - l_discount)) as revenue,
        o_orderdate,
        o_shippriority
from
        customer,
        orders,
        lineitem
where
        c_mktsegment = 'BUILDING'
        and c_custkey = o_custkey
        and l_orderkey = o_orderkey
        and o_orderdate <  cast('1995-03-22' as timestamp)
        and l_shipdate > cast('1995-03-22' as timestamp)
group by
        l_orderkey,
        o_orderdate,
        o_shippriority
order by
        revenue desc,
        o_orderdate
limit 10,,)
Time :7.505 ] 

 
4.23 [ Query :Query(select
        o_orderpriority,
        count(*) as order_count
from
        orders as o
where
        o_orderdate >= cast('1996-05-01' as timestamp)
        and o_orderdate < cast('1996-08-01' as timestamp)
        and exists (
                select
                        *
                from
                        lineitem
                where
                        l_orderkey = o.o_orderkey
                        and l_commitdate < l_receiptdate
        )
group by
        o_orderpriority
order by
        o_orderpriority,,)
Time :4.23 ] 

 
5.136 [ Query :Query(select
        n_name,
        sum(l_extendedprice * (1 - l_discount)) as revenue
from
        customer,
        orders,
        lineitem,
        supplier,
        nation,
        region
where
        c_custkey = o_custkey
        and l_orderkey = o_orderkey
        and l_suppkey = s_suppkey
        and c_nationkey = s_nationkey
        and s_nationkey = n_nationkey
        and n_regionkey = r_regionkey
        and r_name = 'AFRICA'
        and o_orderdate >= cast('1993-01-01' as timestamp)
        and o_orderdate < cast('1994-01-01' as timestamp)
group by
        n_name
order by
        revenue desc,,)
Time :5.136 ] 

 
3.346 [ Query :Query(select
        o_orderpriority,
        count(*) as order_count
from
        orders as o
where
        o_orderdate >= cast('1996-05-01' as timestamp)
        and o_orderdate < cast('1996-08-01' as timestamp)
        and exists (
                select
                        *
                from
                        lineitem
                where
                        l_orderkey = o.o_orderkey
                        and l_commitdate < l_receiptdate
        )
group by
        o_orderpriority
order by
        o_orderpriority,,)
Time :3.346 ] 

 
3.789 [ Query :Query(select
        n_name,
        sum(l_extendedprice * (1 - l_discount)) as revenue
from
        customer,
        orders,
        lineitem,
        supplier,
        nation,
        region
where
        c_custkey = o_custkey
        and l_orderkey = o_orderkey
        and l_suppkey = s_suppkey
        and c_nationkey = s_nationkey
        and s_nationkey = n_nationkey
        and n_regionkey = r_regionkey
        and r_name = 'AFRICA'
        and o_orderdate >= cast('1993-01-01' as timestamp)
        and o_orderdate < cast('1994-01-01' as timestamp) 
group by
        n_name
order by
        revenue desc,,)
Time :3.789 ] 

 
0.397 [ Query :Query(select
        sum(l_extendedprice * l_discount) as revenue
from
        lineitem
where
        l_shipdate >= cast('1993-01-01' as timestamp)
        and l_shipdate < cast('1994-01-01' as timestamp) 
        and l_discount between 0.06 - 0.01 and 0.06 + 0.01
        and l_quantity < 25,,)
Time :0.397 ] 

 
4.345 [ Query :Query(select
        supp_nation,
        cust_nation,
        l_year,
        sum(volume) as revenue
from
        (
                select
                        n1.n_name as supp_nation,
                        n2.n_name as cust_nation,
                        year(l_shipdate) as l_year,
                        l_extendedprice * (1 - l_discount) as volume
                from
                        supplier,
                        lineitem,
                        orders,
                        customer,
                        nation n1,
                        nation n2
                where
                        s_suppkey = l_suppkey
                        and o_orderkey = l_orderkey
                        and c_custkey = o_custkey
                        and s_nationkey = n1.n_nationkey
                        and c_nationkey = n2.n_nationkey
                        and (
                                (n1.n_name = 'KENYA' and n2.n_name = 'PERU')
                                or (n1.n_name = 'PERU' and n2.n_name = 'KENYA')
                        )
                        and l_shipdate between cast('1995-01-01' as timestamp) and cast('1996-12-31' as timestamp)
        ) as shipping
group by
        supp_nation,
        cust_nation,
        l_year
order by
        supp_nation,
        cust_nation,
        l_year,,)
Time :4.345 ] 

 
18.012 [ Query :Query(select
        o_year,
        sum(case
                when nation = 'PERU' then volume
                else 0
        end) / sum(volume) as mkt_share
from
        (
                select
                        year(o_orderdate) as o_year,
                        l_extendedprice * (1 - l_discount) as volume,
                        n2.n_name as nation
                from
                        part,
                        supplier,
                        lineitem,
                        orders,
                        customer,
                        nation n1,
                        nation n2,
                        region
                where
                        p_partkey = l_partkey
                        and s_suppkey = l_suppkey
                        and l_orderkey = o_orderkey
                        and o_custkey = c_custkey
                        and c_nationkey = n1.n_nationkey
                        and n1.n_regionkey = r_regionkey
                        and r_name = 'AMERICA'
                        and s_nationkey = n2.n_nationkey
                        and o_orderdate between cast('1995-01-01' as timestamp) and  cast('1996-12-31' as timestamp)
                        and p_type = 'ECONOMY BURNISHED NICKEL'
        ) as all_nations
group by
        o_year
order by
        o_year,,)
Time :18.012 ] 

 
5.421 [ Query :Query(select
        c_custkey,
        c_name,
        sum(l_extendedprice * (1 - l_discount)) as revenue,
        c_acctbal,
        n_name,
        c_address,
        c_phone,
        c_comment
from
        customer,
        orders,
        lineitem,
        nation
where
        c_custkey = o_custkey
        and l_orderkey = o_orderkey
        and o_orderdate >= cast('1993-07-01' as timestamp)
        and o_orderdate < cast('1993-10-01' as timestamp)
        and l_returnflag = 'R'
        and c_nationkey = n_nationkey
group by
        c_custkey,
        c_name,
        c_acctbal,
        c_phone,
        n_name,
        c_address,
        c_comment
order by
        revenue desc
limit 20,,)
Time :5.421 ] 

 
3.685 [ Query :Query(select
        l_shipmode,
        sum(case
                when o_orderpriority = '1-URGENT'
                        or o_orderpriority = '2-HIGH'
                        then 1
                else 0
        end) as high_line_count,
        sum(case
                when o_orderpriority <> '1-URGENT'
                        and o_orderpriority <> '2-HIGH'
                        then 1
                else 0
        end) as low_line_count
from
        orders,
        lineitem
where
        o_orderkey = l_orderkey
        and l_shipmode in ('REG AIR', 'MAIL')
        and l_commitdate < l_receiptdate
        and l_shipdate < l_commitdate
        and l_receiptdate >= cast('1995-01-01' as timestamp) 
        and l_receiptdate < cast('1996-01-01' as timestamp) 
group by
        l_shipmode
order by
        l_shipmode,,)
Time :3.685 ] 

 
8.543 [ Query :Query(select
        c_count,
        count(*) as custdist
from
        (
                select
                        c_custkey,
                        count(o_orderkey) as c_count
                from
                        customer left outer join orders on
                                c_custkey = o_custkey
                                and o_comment not like '%unusual%accounts%'
                group by
                        c_custkey
        ) c_orders
group by
        c_count
order by
        custdist desc,
        c_count desc,,)
Time :8.543 ] 

 
1.109 [ Query :Query(select
        100.00 * sum(case
                when p_type like 'PROMO%'
                        then l_extendedprice * (1 - l_discount)
                else 0
        end) / sum(l_extendedprice * (1 - l_discount)) as promo_revenue
from
        lineitem,
        part
where
        l_partkey = p_partkey
        and l_shipdate >= cast('1995-08-01' as timestamp) 
        and l_shipdate < cast('1995-09-01' as timestamp),,)
Time :1.109 ] 

 
6.696 [ Query :Query(select
        p_brand,
        p_type,
        p_size,
        count(distinct ps_suppkey) as supplier_cnt
from
        partsupp,
        part
where
        p_partkey = ps_partkey
        and p_brand <> 'Brand#34'
        and p_type not like 'ECONOMY BRUSHED%'
        and p_size in (22, 14, 27, 49, 21, 33, 35, 28)
        and partsupp.ps_suppkey not in (
                select
                        s_suppkey
                from
                        supplier
                where
                        s_comment like '%Customer%Complaints%'
        )
group by
        p_brand,
        p_type,
        p_size
order by
        supplier_cnt desc,
        p_brand,
        p_type,
        p_size,,)
Time :6.696 ] 

 
2.17 [ Query :Query(with q17_part as (
  select p_partkey from part where  
  p_brand = 'Brand#23'
  and p_container = 'MED BOX'
),
q17_avg as (
  select l_partkey as t_partkey, 0.2 * avg(l_quantity) as t_avg_quantity
  from lineitem 
  where l_partkey IN (select p_partkey from q17_part)
  group by l_partkey
),
q17_price as (
  select
  l_quantity,
  l_partkey,
  l_extendedprice
  from
  lineitem
  where
  l_partkey IN (select p_partkey from q17_part)
)
select cast(sum(l_extendedprice) / 7.0 as decimal(32,2)) as avg_yearly
from q17_avg, q17_price
where 
t_partkey = l_partkey and l_quantity < t_avg_quantity,,)
Time :2.17 ] 

 
2.766 [ Query :Query(-- explain formatted 
with tmp1 as (
    select p_partkey from part where p_name like 'forest%'
),
tmp2 as (
    select s_name, s_address, s_suppkey
    from supplier, nation
    where s_nationkey = n_nationkey
    and n_name = 'CANADA'
),
tmp3 as (
    select l_partkey, 0.5 * sum(l_quantity) as sum_quantity, l_suppkey
    from lineitem, tmp2
    where l_shipdate >= cast('1994-01-01' as timestamp) and l_shipdate <= cast('1995-01-01' as timestamp)
    and l_suppkey = s_suppkey 
    group by l_partkey, l_suppkey
),
tmp4 as (
    select ps_partkey, ps_suppkey, ps_availqty
    from partsupp 
    where ps_partkey IN (select p_partkey from tmp1)
),
tmp5 as (
select
    ps_suppkey
from
    tmp4, tmp3
where
    ps_partkey = l_partkey
    and ps_suppkey = l_suppkey
    and ps_availqty > sum_quantity
)
select
    s_name,
    s_address
from
    supplier
where
    s_suppkey IN (select ps_suppkey from tmp5)
order by s_name,,)
Time :2.766 ] 

 
10.392 [ Query :Query(select
        l_returnflag,
        l_linestatus,
        sum(l_quantity) as sum_qty,
        sum(l_extendedprice) as sum_base_price,
        sum(l_extendedprice * (1 - l_discount)) as sum_disc_price,
        sum(l_extendedprice * (1 - l_discount) * (1 + l_tax)) as sum_charge,
        avg(l_quantity) as avg_qty,
        avg(l_extendedprice) as avg_price,
        avg(l_discount) as avg_disc,
        count(*) as count_order
from
        lineitem
where
        l_shipdate <= cast('1998-09-16' as timestamp)
group by
        l_returnflag,
        l_linestatus
order by
        l_returnflag,
        l_linestatus,,)
Time :10.392 ] 

 
9.055 [ Query :Query(select
        l_orderkey,
        sum(l_extendedprice * (1 - l_discount)) as revenue,
        o_orderdate,
        o_shippriority
from
        customer,
        orders,
        lineitem
where
        c_mktsegment = 'BUILDING'
        and c_custkey = o_custkey
        and l_orderkey = o_orderkey
        and o_orderdate <  cast('1995-03-22' as timestamp)
        and l_shipdate > cast('1995-03-22' as timestamp)
group by
        l_orderkey,
        o_orderdate,
        o_shippriority
order by
        revenue desc,
        o_orderdate
limit 10,,)
Time :9.055 ] 

 
3.99 [ Query :Query(select
        o_orderpriority,
        count(*) as order_count
from
        orders as o
where
        o_orderdate >= cast('1996-05-01' as timestamp)
        and o_orderdate < cast('1996-08-01' as timestamp)
        and exists (
                select
                        *
                from
                        lineitem
                where
                        l_orderkey = o.o_orderkey
                        and l_commitdate < l_receiptdate
        )
group by
        o_orderpriority
order by
        o_orderpriority,,)
Time :3.99 ] 

 
5.161 [ Query :Query(select
        n_name,
        sum(l_extendedprice * (1 - l_discount)) as revenue
from
        customer,
        orders,
        lineitem,
        supplier,
        nation,
        region
where
        c_custkey = o_custkey
        and l_orderkey = o_orderkey
        and l_suppkey = s_suppkey
        and c_nationkey = s_nationkey
        and s_nationkey = n_nationkey
        and n_regionkey = r_regionkey
        and r_name = 'AFRICA'
        and o_orderdate >= cast('1993-01-01' as timestamp)
        and o_orderdate < cast('1994-01-01' as timestamp)
group by
        n_name
order by
        revenue desc,,)
Time :5.161 ] 

 
3.187 [ Query :Query(select
        o_orderpriority,
        count(*) as order_count
from
        orders as o
where
        o_orderdate >= cast('1996-05-01' as timestamp)
        and o_orderdate < cast('1996-08-01' as timestamp)
        and exists (
                select
                        *
                from
                        lineitem
                where
                        l_orderkey = o.o_orderkey
                        and l_commitdate < l_receiptdate
        )
group by
        o_orderpriority
order by
        o_orderpriority,,)
Time :3.187 ] 

 
4.947 [ Query :Query(select
        n_name,
        sum(l_extendedprice * (1 - l_discount)) as revenue
from
        customer,
        orders,
        lineitem,
        supplier,
        nation,
        region
where
        c_custkey = o_custkey
        and l_orderkey = o_orderkey
        and l_suppkey = s_suppkey
        and c_nationkey = s_nationkey
        and s_nationkey = n_nationkey
        and n_regionkey = r_regionkey
        and r_name = 'AFRICA'
        and o_orderdate >= cast('1993-01-01' as timestamp)
        and o_orderdate < cast('1994-01-01' as timestamp) 
group by
        n_name
order by
        revenue desc,,)
Time :4.947 ] 

 
0.372 [ Query :Query(select
        sum(l_extendedprice * l_discount) as revenue
from
        lineitem
where
        l_shipdate >= cast('1993-01-01' as timestamp)
        and l_shipdate < cast('1994-01-01' as timestamp) 
        and l_discount between 0.06 - 0.01 and 0.06 + 0.01
        and l_quantity < 25,,)
Time :0.372 ] 

 
4.473 [ Query :Query(select
        supp_nation,
        cust_nation,
        l_year,
        sum(volume) as revenue
from
        (
                select
                        n1.n_name as supp_nation,
                        n2.n_name as cust_nation,
                        year(l_shipdate) as l_year,
                        l_extendedprice * (1 - l_discount) as volume
                from
                        supplier,
                        lineitem,
                        orders,
                        customer,
                        nation n1,
                        nation n2
                where
                        s_suppkey = l_suppkey
                        and o_orderkey = l_orderkey
                        and c_custkey = o_custkey
                        and s_nationkey = n1.n_nationkey
                        and c_nationkey = n2.n_nationkey
                        and (
                                (n1.n_name = 'KENYA' and n2.n_name = 'PERU')
                                or (n1.n_name = 'PERU' and n2.n_name = 'KENYA')
                        )
                        and l_shipdate between cast('1995-01-01' as timestamp) and cast('1996-12-31' as timestamp)
        ) as shipping
group by
        supp_nation,
        cust_nation,
        l_year
order by
        supp_nation,
        cust_nation,
        l_year,,)
Time :4.473 ] 

 
18.297 [ Query :Query(select
        o_year,
        sum(case
                when nation = 'PERU' then volume
                else 0
        end) / sum(volume) as mkt_share
from
        (
                select
                        year(o_orderdate) as o_year,
                        l_extendedprice * (1 - l_discount) as volume,
                        n2.n_name as nation
                from
                        part,
                        supplier,
                        lineitem,
                        orders,
                        customer,
                        nation n1,
                        nation n2,
                        region
                where
                        p_partkey = l_partkey
                        and s_suppkey = l_suppkey
                        and l_orderkey = o_orderkey
                        and o_custkey = c_custkey
                        and c_nationkey = n1.n_nationkey
                        and n1.n_regionkey = r_regionkey
                        and r_name = 'AMERICA'
                        and s_nationkey = n2.n_nationkey
                        and o_orderdate between cast('1995-01-01' as timestamp) and  cast('1996-12-31' as timestamp)
                        and p_type = 'ECONOMY BURNISHED NICKEL'
        ) as all_nations
group by
        o_year
order by
        o_year,,)
Time :18.297 ] 

 
4.678 [ Query :Query(select
        c_custkey,
        c_name,
        sum(l_extendedprice * (1 - l_discount)) as revenue,
        c_acctbal,
        n_name,
        c_address,
        c_phone,
        c_comment
from
        customer,
        orders,
        lineitem,
        nation
where
        c_custkey = o_custkey
        and l_orderkey = o_orderkey
        and o_orderdate >= cast('1993-07-01' as timestamp)
        and o_orderdate < cast('1993-10-01' as timestamp)
        and l_returnflag = 'R'
        and c_nationkey = n_nationkey
group by
        c_custkey,
        c_name,
        c_acctbal,
        c_phone,
        n_name,
        c_address,
        c_comment
order by
        revenue desc
limit 20,,)
Time :4.678 ] 

 
3.047 [ Query :Query(select
        l_shipmode,
        sum(case
                when o_orderpriority = '1-URGENT'
                        or o_orderpriority = '2-HIGH'
                        then 1
                else 0
        end) as high_line_count,
        sum(case
                when o_orderpriority <> '1-URGENT'
                        and o_orderpriority <> '2-HIGH'
                        then 1
                else 0
        end) as low_line_count
from
        orders,
        lineitem
where
        o_orderkey = l_orderkey
        and l_shipmode in ('REG AIR', 'MAIL')
        and l_commitdate < l_receiptdate
        and l_shipdate < l_commitdate
        and l_receiptdate >= cast('1995-01-01' as timestamp) 
        and l_receiptdate < cast('1996-01-01' as timestamp) 
group by
        l_shipmode
order by
        l_shipmode,,)
Time :3.047 ] 

 
7.235 [ Query :Query(select
        c_count,
        count(*) as custdist
from
        (
                select
                        c_custkey,
                        count(o_orderkey) as c_count
                from
                        customer left outer join orders on
                                c_custkey = o_custkey
                                and o_comment not like '%unusual%accounts%'
                group by
                        c_custkey
        ) c_orders
group by
        c_count
order by
        custdist desc,
        c_count desc,,)
Time :7.235 ] 

 
1.076 [ Query :Query(select
        100.00 * sum(case
                when p_type like 'PROMO%'
                        then l_extendedprice * (1 - l_discount)
                else 0
        end) / sum(l_extendedprice * (1 - l_discount)) as promo_revenue
from
        lineitem,
        part
where
        l_partkey = p_partkey
        and l_shipdate >= cast('1995-08-01' as timestamp) 
        and l_shipdate < cast('1995-09-01' as timestamp),,)
Time :1.076 ] 

 
3.288 [ Query :Query(select
        p_brand,
        p_type,
        p_size,
        count(distinct ps_suppkey) as supplier_cnt
from
        partsupp,
        part
where
        p_partkey = ps_partkey
        and p_brand <> 'Brand#34'
        and p_type not like 'ECONOMY BRUSHED%'
        and p_size in (22, 14, 27, 49, 21, 33, 35, 28)
        and partsupp.ps_suppkey not in (
                select
                        s_suppkey
                from
                        supplier
                where
                        s_comment like '%Customer%Complaints%'
        )
group by
        p_brand,
        p_type,
        p_size
order by
        supplier_cnt desc,
        p_brand,
        p_type,
        p_size,,)
Time :3.288 ] 

 
0.6 [ Query :Query(with q17_part as (
  select p_partkey from part where  
  p_brand = 'Brand#23'
  and p_container = 'MED BOX'
),
q17_avg as (
  select l_partkey as t_partkey, 0.2 * avg(l_quantity) as t_avg_quantity
  from lineitem 
  where l_partkey IN (select p_partkey from q17_part)
  group by l_partkey
),
q17_price as (
  select
  l_quantity,
  l_partkey,
  l_extendedprice
  from
  lineitem
  where
  l_partkey IN (select p_partkey from q17_part)
)
select cast(sum(l_extendedprice) / 7.0 as decimal(32,2)) as avg_yearly
from q17_avg, q17_price
where 
t_partkey = l_partkey and l_quantity < t_avg_quantity,,)
Time :0.6 ] 

 
2.197 [ Query :Query(-- explain formatted 
with tmp1 as (
    select p_partkey from part where p_name like 'forest%'
),
tmp2 as (
    select s_name, s_address, s_suppkey
    from supplier, nation
    where s_nationkey = n_nationkey
    and n_name = 'CANADA'
),
tmp3 as (
    select l_partkey, 0.5 * sum(l_quantity) as sum_quantity, l_suppkey
    from lineitem, tmp2
    where l_shipdate >= cast('1994-01-01' as timestamp) and l_shipdate <= cast('1995-01-01' as timestamp)
    and l_suppkey = s_suppkey 
    group by l_partkey, l_suppkey
),
tmp4 as (
    select ps_partkey, ps_suppkey, ps_availqty
    from partsupp 
    where ps_partkey IN (select p_partkey from tmp1)
),
tmp5 as (
select
    ps_suppkey
from
    tmp4, tmp3
where
    ps_partkey = l_partkey
    and ps_suppkey = l_suppkey
    and ps_availqty > sum_quantity
)
select
    s_name,
    s_address
from
    supplier
where
    s_suppkey IN (select ps_suppkey from tmp5)
order by s_name,,)
Time :2.197 ] 

 
605.559 [ Query :Query(select o_custkey from orders where O_ORDERSTATUS = 'F' and o_custkey >= 143695 limit 10,,)
Time :605.559 ] 

 
5.055 [ Query :Query(select
        l_returnflag,
        l_linestatus,
        sum(l_quantity) as sum_qty,
        sum(l_extendedprice) as sum_base_price,
        sum(l_extendedprice * (1 - l_discount)) as sum_disc_price,
        sum(l_extendedprice * (1 - l_discount) * (1 + l_tax)) as sum_charge,
        avg(l_quantity) as avg_qty,
        avg(l_extendedprice) as avg_price,
        avg(l_discount) as avg_disc,
        count(*) as count_order
from
        lineitem
where
        l_shipdate <= cast('1998-09-16' as timestamp)
group by
        l_returnflag,
        l_linestatus
order by
        l_returnflag,
        l_linestatus,,)
Time :5.055 ] 

 
6.372 [ Query :Query(select
        l_orderkey,
        sum(l_extendedprice * (1 - l_discount)) as revenue,
        o_orderdate,
        o_shippriority
from
        customer,
        orders,
        lineitem
where
        c_mktsegment = 'BUILDING'
        and c_custkey = o_custkey
        and l_orderkey = o_orderkey
        and o_orderdate <  cast('1995-03-22' as timestamp)
        and l_shipdate > cast('1995-03-22' as timestamp)
group by
        l_orderkey,
        o_orderdate,
        o_shippriority
order by
        revenue desc,
        o_orderdate
limit 10,,)
Time :6.372 ] 

 
4.297 [ Query :Query(select
        o_orderpriority,
        count(*) as order_count
from
        orders as o
where
        o_orderdate >= cast('1996-05-01' as timestamp)
        and o_orderdate < cast('1996-08-01' as timestamp)
        and exists (
                select
                        *
                from
                        lineitem
                where
                        l_orderkey = o.o_orderkey
                        and l_commitdate < l_receiptdate
        )
group by
        o_orderpriority
order by
        o_orderpriority,,)
Time :4.297 ] 

 
5.746 [ Query :Query(select
        n_name,
        sum(l_extendedprice * (1 - l_discount)) as revenue
from
        customer,
        orders,
        lineitem,
        supplier,
        nation,
        region
where
        c_custkey = o_custkey
        and l_orderkey = o_orderkey
        and l_suppkey = s_suppkey
        and c_nationkey = s_nationkey
        and s_nationkey = n_nationkey
        and n_regionkey = r_regionkey
        and r_name = 'AFRICA'
        and o_orderdate >= cast('1993-01-01' as timestamp)
        and o_orderdate < cast('1994-01-01' as timestamp)
group by
        n_name
order by
        revenue desc,,)
Time :5.746 ] 

 
3.448 [ Query :Query(select
        o_orderpriority,
        count(*) as order_count
from
        orders as o
where
        o_orderdate >= cast('1996-05-01' as timestamp)
        and o_orderdate < cast('1996-08-01' as timestamp)
        and exists (
                select
                        *
                from
                        lineitem
                where
                        l_orderkey = o.o_orderkey
                        and l_commitdate < l_receiptdate
        )
group by
        o_orderpriority
order by
        o_orderpriority,,)
Time :3.448 ] 

 
3.254 [ Query :Query(select
        n_name,
        sum(l_extendedprice * (1 - l_discount)) as revenue
from
        customer,
        orders,
        lineitem,
        supplier,
        nation,
        region
where
        c_custkey = o_custkey
        and l_orderkey = o_orderkey
        and l_suppkey = s_suppkey
        and c_nationkey = s_nationkey
        and s_nationkey = n_nationkey
        and n_regionkey = r_regionkey
        and r_name = 'AFRICA'
        and o_orderdate >= cast('1993-01-01' as timestamp)
        and o_orderdate < cast('1994-01-01' as timestamp) 
group by
        n_name
order by
        revenue desc,,)
Time :3.254 ] 

 
0.387 [ Query :Query(select
        sum(l_extendedprice * l_discount) as revenue
from
        lineitem
where
        l_shipdate >= cast('1993-01-01' as timestamp)
        and l_shipdate < cast('1994-01-01' as timestamp) 
        and l_discount between 0.06 - 0.01 and 0.06 + 0.01
        and l_quantity < 25,,)
Time :0.387 ] 

 
3.827 [ Query :Query(select
        supp_nation,
        cust_nation,
        l_year,
        sum(volume) as revenue
from
        (
                select
                        n1.n_name as supp_nation,
                        n2.n_name as cust_nation,
                        year(l_shipdate) as l_year,
                        l_extendedprice * (1 - l_discount) as volume
                from
                        supplier,
                        lineitem,
                        orders,
                        customer,
                        nation n1,
                        nation n2
                where
                        s_suppkey = l_suppkey
                        and o_orderkey = l_orderkey
                        and c_custkey = o_custkey
                        and s_nationkey = n1.n_nationkey
                        and c_nationkey = n2.n_nationkey
                        and (
                                (n1.n_name = 'KENYA' and n2.n_name = 'PERU')
                                or (n1.n_name = 'PERU' and n2.n_name = 'KENYA')
                        )
                        and l_shipdate between cast('1995-01-01' as timestamp) and cast('1996-12-31' as timestamp)
        ) as shipping
group by
        supp_nation,
        cust_nation,
        l_year
order by
        supp_nation,
        cust_nation,
        l_year,,)
Time :3.827 ] 

 
17.829 [ Query :Query(select
        o_year,
        sum(case
                when nation = 'PERU' then volume
                else 0
        end) / sum(volume) as mkt_share
from
        (
                select
                        year(o_orderdate) as o_year,
                        l_extendedprice * (1 - l_discount) as volume,
                        n2.n_name as nation
                from
                        part,
                        supplier,
                        lineitem,
                        orders,
                        customer,
                        nation n1,
                        nation n2,
                        region
                where
                        p_partkey = l_partkey
                        and s_suppkey = l_suppkey
                        and l_orderkey = o_orderkey
                        and o_custkey = c_custkey
                        and c_nationkey = n1.n_nationkey
                        and n1.n_regionkey = r_regionkey
                        and r_name = 'AMERICA'
                        and s_nationkey = n2.n_nationkey
                        and o_orderdate between cast('1995-01-01' as timestamp) and  cast('1996-12-31' as timestamp)
                        and p_type = 'ECONOMY BURNISHED NICKEL'
        ) as all_nations
group by
        o_year
order by
        o_year,,)
Time :17.829 ] 

 
5.613 [ Query :Query(select
        c_custkey,
        c_name,
        sum(l_extendedprice * (1 - l_discount)) as revenue,
        c_acctbal,
        n_name,
        c_address,
        c_phone,
        c_comment
from
        customer,
        orders,
        lineitem,
        nation
where
        c_custkey = o_custkey
        and l_orderkey = o_orderkey
        and o_orderdate >= cast('1993-07-01' as timestamp)
        and o_orderdate < cast('1993-10-01' as timestamp)
        and l_returnflag = 'R'
        and c_nationkey = n_nationkey
group by
        c_custkey,
        c_name,
        c_acctbal,
        c_phone,
        n_name,
        c_address,
        c_comment
order by
        revenue desc
limit 20,,)
Time :5.613 ] 

 
3.015 [ Query :Query(select
        l_shipmode,
        sum(case
                when o_orderpriority = '1-URGENT'
                        or o_orderpriority = '2-HIGH'
                        then 1
                else 0
        end) as high_line_count,
        sum(case
                when o_orderpriority <> '1-URGENT'
                        and o_orderpriority <> '2-HIGH'
                        then 1
                else 0
        end) as low_line_count
from
        orders,
        lineitem
where
        o_orderkey = l_orderkey
        and l_shipmode in ('REG AIR', 'MAIL')
        and l_commitdate < l_receiptdate
        and l_shipdate < l_commitdate
        and l_receiptdate >= cast('1995-01-01' as timestamp) 
        and l_receiptdate < cast('1996-01-01' as timestamp) 
group by
        l_shipmode
order by
        l_shipmode,,)
Time :3.015 ] 

 
8.144 [ Query :Query(select
        c_count,
        count(*) as custdist
from
        (
                select
                        c_custkey,
                        count(o_orderkey) as c_count
                from
                        customer left outer join orders on
                                c_custkey = o_custkey
                                and o_comment not like '%unusual%accounts%'
                group by
                        c_custkey
        ) c_orders
group by
        c_count
order by
        custdist desc,
        c_count desc,,)
Time :8.144 ] 

 
0.793 [ Query :Query(select
        100.00 * sum(case
                when p_type like 'PROMO%'
                        then l_extendedprice * (1 - l_discount)
                else 0
        end) / sum(l_extendedprice * (1 - l_discount)) as promo_revenue
from
        lineitem,
        part
where
        l_partkey = p_partkey
        and l_shipdate >= cast('1995-08-01' as timestamp) 
        and l_shipdate < cast('1995-09-01' as timestamp),,)
Time :0.793 ] 

 
3.584 [ Query :Query(select
        p_brand,
        p_type,
        p_size,
        count(distinct ps_suppkey) as supplier_cnt
from
        partsupp,
        part
where
        p_partkey = ps_partkey
        and p_brand <> 'Brand#34'
        and p_type not like 'ECONOMY BRUSHED%'
        and p_size in (22, 14, 27, 49, 21, 33, 35, 28)
        and partsupp.ps_suppkey not in (
                select
                        s_suppkey
                from
                        supplier
                where
                        s_comment like '%Customer%Complaints%'
        )
group by
        p_brand,
        p_type,
        p_size
order by
        supplier_cnt desc,
        p_brand,
        p_type,
        p_size,,)
Time :3.584 ] 

 
0.563 [ Query :Query(with q17_part as (
  select p_partkey from part where  
  p_brand = 'Brand#23'
  and p_container = 'MED BOX'
),
q17_avg as (
  select l_partkey as t_partkey, 0.2 * avg(l_quantity) as t_avg_quantity
  from lineitem 
  where l_partkey IN (select p_partkey from q17_part)
  group by l_partkey
),
q17_price as (
  select
  l_quantity,
  l_partkey,
  l_extendedprice
  from
  lineitem
  where
  l_partkey IN (select p_partkey from q17_part)
)
select cast(sum(l_extendedprice) / 7.0 as decimal(32,2)) as avg_yearly
from q17_avg, q17_price
where 
t_partkey = l_partkey and l_quantity < t_avg_quantity,,)
Time :0.563 ] 

 
4.6 [ Query :Query(-- explain formatted 
with tmp1 as (
    select p_partkey from part where p_name like 'forest%'
),
tmp2 as (
    select s_name, s_address, s_suppkey
    from supplier, nation
    where s_nationkey = n_nationkey
    and n_name = 'CANADA'
),
tmp3 as (
    select l_partkey, 0.5 * sum(l_quantity) as sum_quantity, l_suppkey
    from lineitem, tmp2
    where l_shipdate >= cast('1994-01-01' as timestamp) and l_shipdate <= cast('1995-01-01' as timestamp)
    and l_suppkey = s_suppkey 
    group by l_partkey, l_suppkey
),
tmp4 as (
    select ps_partkey, ps_suppkey, ps_availqty
    from partsupp 
    where ps_partkey IN (select p_partkey from tmp1)
),
tmp5 as (
select
    ps_suppkey
from
    tmp4, tmp3
where
    ps_partkey = l_partkey
    and ps_suppkey = l_suppkey
    and ps_availqty > sum_quantity
)
select
    s_name,
    s_address
from
    supplier
where
    s_suppkey IN (select ps_suppkey from tmp5)
order by s_name,,)
Time :4.6 ] 

 
4.068 [ Query :Query(select
        l_returnflag,
        l_linestatus,
        sum(l_quantity) as sum_qty,
        sum(l_extendedprice) as sum_base_price,
        sum(l_extendedprice * (1 - l_discount)) as sum_disc_price,
        sum(l_extendedprice * (1 - l_discount) * (1 + l_tax)) as sum_charge,
        avg(l_quantity) as avg_qty,
        avg(l_extendedprice) as avg_price,
        avg(l_discount) as avg_disc,
        count(*) as count_order
from
        lineitem
where
        l_shipdate <= cast('1998-09-16' as timestamp)
group by
        l_returnflag,
        l_linestatus
order by
        l_returnflag,
        l_linestatus,,)
Time :4.068 ] 

 
6.414 [ Query :Query(select
        l_orderkey,
        sum(l_extendedprice * (1 - l_discount)) as revenue,
        o_orderdate,
        o_shippriority
from
        customer,
        orders,
        lineitem
where
        c_mktsegment = 'BUILDING'
        and c_custkey = o_custkey
        and l_orderkey = o_orderkey
        and o_orderdate <  cast('1995-03-22' as timestamp)
        and l_shipdate > cast('1995-03-22' as timestamp)
group by
        l_orderkey,
        o_orderdate,
        o_shippriority
order by
        revenue desc,
        o_orderdate
limit 10,,)
Time :6.414 ] 

 
4.069 [ Query :Query(select
        o_orderpriority,
        count(*) as order_count
from
        orders as o
where
        o_orderdate >= cast('1996-05-01' as timestamp)
        and o_orderdate < cast('1996-08-01' as timestamp)
        and exists (
                select
                        *
                from
                        lineitem
                where
                        l_orderkey = o.o_orderkey
                        and l_commitdate < l_receiptdate
        )
group by
        o_orderpriority
order by
        o_orderpriority,,)
Time :4.069 ] 

 
5.588 [ Query :Query(select
        n_name,
        sum(l_extendedprice * (1 - l_discount)) as revenue
from
        customer,
        orders,
        lineitem,
        supplier,
        nation,
        region
where
        c_custkey = o_custkey
        and l_orderkey = o_orderkey
        and l_suppkey = s_suppkey
        and c_nationkey = s_nationkey
        and s_nationkey = n_nationkey
        and n_regionkey = r_regionkey
        and r_name = 'AFRICA'
        and o_orderdate >= cast('1993-01-01' as timestamp)
        and o_orderdate < cast('1994-01-01' as timestamp)
group by
        n_name
order by
        revenue desc,,)
Time :5.588 ] 

 
3.232 [ Query :Query(select
        o_orderpriority,
        count(*) as order_count
from
        orders as o
where
        o_orderdate >= cast('1996-05-01' as timestamp)
        and o_orderdate < cast('1996-08-01' as timestamp)
        and exists (
                select
                        *
                from
                        lineitem
                where
                        l_orderkey = o.o_orderkey
                        and l_commitdate < l_receiptdate
        )
group by
        o_orderpriority
order by
        o_orderpriority,,)
Time :3.232 ] 

 
3.514 [ Query :Query(select
        n_name,
        sum(l_extendedprice * (1 - l_discount)) as revenue
from
        customer,
        orders,
        lineitem,
        supplier,
        nation,
        region
where
        c_custkey = o_custkey
        and l_orderkey = o_orderkey
        and l_suppkey = s_suppkey
        and c_nationkey = s_nationkey
        and s_nationkey = n_nationkey
        and n_regionkey = r_regionkey
        and r_name = 'AFRICA'
        and o_orderdate >= cast('1993-01-01' as timestamp)
        and o_orderdate < cast('1994-01-01' as timestamp) 
group by
        n_name
order by
        revenue desc,,)
Time :3.514 ] 

 
0.301 [ Query :Query(select
        sum(l_extendedprice * l_discount) as revenue
from
        lineitem
where
        l_shipdate >= cast('1993-01-01' as timestamp)
        and l_shipdate < cast('1994-01-01' as timestamp) 
        and l_discount between 0.06 - 0.01 and 0.06 + 0.01
        and l_quantity < 25,,)
Time :0.301 ] 

 
3.909 [ Query :Query(select
        supp_nation,
        cust_nation,
        l_year,
        sum(volume) as revenue
from
        (
                select
                        n1.n_name as supp_nation,
                        n2.n_name as cust_nation,
                        year(l_shipdate) as l_year,
                        l_extendedprice * (1 - l_discount) as volume
                from
                        supplier,
                        lineitem,
                        orders,
                        customer,
                        nation n1,
                        nation n2
                where
                        s_suppkey = l_suppkey
                        and o_orderkey = l_orderkey
                        and c_custkey = o_custkey
                        and s_nationkey = n1.n_nationkey
                        and c_nationkey = n2.n_nationkey
                        and (
                                (n1.n_name = 'KENYA' and n2.n_name = 'PERU')
                                or (n1.n_name = 'PERU' and n2.n_name = 'KENYA')
                        )
                        and l_shipdate between cast('1995-01-01' as timestamp) and cast('1996-12-31' as timestamp)
        ) as shipping
group by
        supp_nation,
        cust_nation,
        l_year
order by
        supp_nation,
        cust_nation,
        l_year,,)
Time :3.909 ] 

 
21.849 [ Query :Query(select
        o_year,
        sum(case
                when nation = 'PERU' then volume
                else 0
        end) / sum(volume) as mkt_share
from
        (
                select
                        year(o_orderdate) as o_year,
                        l_extendedprice * (1 - l_discount) as volume,
                        n2.n_name as nation
                from
                        part,
                        supplier,
                        lineitem,
                        orders,
                        customer,
                        nation n1,
                        nation n2,
                        region
                where
                        p_partkey = l_partkey
                        and s_suppkey = l_suppkey
                        and l_orderkey = o_orderkey
                        and o_custkey = c_custkey
                        and c_nationkey = n1.n_nationkey
                        and n1.n_regionkey = r_regionkey
                        and r_name = 'AMERICA'
                        and s_nationkey = n2.n_nationkey
                        and o_orderdate between cast('1995-01-01' as timestamp) and  cast('1996-12-31' as timestamp)
                        and p_type = 'ECONOMY BURNISHED NICKEL'
        ) as all_nations
group by
        o_year
order by
        o_year,,)
Time :21.849 ] 

 
4.557 [ Query :Query(select
        c_custkey,
        c_name,
        sum(l_extendedprice * (1 - l_discount)) as revenue,
        c_acctbal,
        n_name,
        c_address,
        c_phone,
        c_comment
from
        customer,
        orders,
        lineitem,
        nation
where
        c_custkey = o_custkey
        and l_orderkey = o_orderkey
        and o_orderdate >= cast('1993-07-01' as timestamp)
        and o_orderdate < cast('1993-10-01' as timestamp)
        and l_returnflag = 'R'
        and c_nationkey = n_nationkey
group by
        c_custkey,
        c_name,
        c_acctbal,
        c_phone,
        n_name,
        c_address,
        c_comment
order by
        revenue desc
limit 20,,)
Time :4.557 ] 

 
3.418 [ Query :Query(select
        l_shipmode,
        sum(case
                when o_orderpriority = '1-URGENT'
                        or o_orderpriority = '2-HIGH'
                        then 1
                else 0
        end) as high_line_count,
        sum(case
                when o_orderpriority <> '1-URGENT'
                        and o_orderpriority <> '2-HIGH'
                        then 1
                else 0
        end) as low_line_count
from
        orders,
        lineitem
where
        o_orderkey = l_orderkey
        and l_shipmode in ('REG AIR', 'MAIL')
        and l_commitdate < l_receiptdate
        and l_shipdate < l_commitdate
        and l_receiptdate >= cast('1995-01-01' as timestamp) 
        and l_receiptdate < cast('1996-01-01' as timestamp) 
group by
        l_shipmode
order by
        l_shipmode,,)
Time :3.418 ] 

 
9.618 [ Query :Query(select
        c_count,
        count(*) as custdist
from
        (
                select
                        c_custkey,
                        count(o_orderkey) as c_count
                from
                        customer left outer join orders on
                                c_custkey = o_custkey
                                and o_comment not like '%unusual%accounts%'
                group by
                        c_custkey
        ) c_orders
group by
        c_count
order by
        custdist desc,
        c_count desc,,)
Time :9.618 ] 

 
0.826 [ Query :Query(select
        100.00 * sum(case
                when p_type like 'PROMO%'
                        then l_extendedprice * (1 - l_discount)
                else 0
        end) / sum(l_extendedprice * (1 - l_discount)) as promo_revenue
from
        lineitem,
        part
where
        l_partkey = p_partkey
        and l_shipdate >= cast('1995-08-01' as timestamp) 
        and l_shipdate < cast('1995-09-01' as timestamp),,)
Time :0.826 ] 

 
3.022 [ Query :Query(select
        p_brand,
        p_type,
        p_size,
        count(distinct ps_suppkey) as supplier_cnt
from
        partsupp,
        part
where
        p_partkey = ps_partkey
        and p_brand <> 'Brand#34'
        and p_type not like 'ECONOMY BRUSHED%'
        and p_size in (22, 14, 27, 49, 21, 33, 35, 28)
        and partsupp.ps_suppkey not in (
                select
                        s_suppkey
                from
                        supplier
                where
                        s_comment like '%Customer%Complaints%'
        )
group by
        p_brand,
        p_type,
        p_size
order by
        supplier_cnt desc,
        p_brand,
        p_type,
        p_size,,)
Time :3.022 ] 

 
0.561 [ Query :Query(with q17_part as (
  select p_partkey from part where  
  p_brand = 'Brand#23'
  and p_container = 'MED BOX'
),
q17_avg as (
  select l_partkey as t_partkey, 0.2 * avg(l_quantity) as t_avg_quantity
  from lineitem 
  where l_partkey IN (select p_partkey from q17_part)
  group by l_partkey
),
q17_price as (
  select
  l_quantity,
  l_partkey,
  l_extendedprice
  from
  lineitem
  where
  l_partkey IN (select p_partkey from q17_part)
)
select cast(sum(l_extendedprice) / 7.0 as decimal(32,2)) as avg_yearly
from q17_avg, q17_price
where 
t_partkey = l_partkey and l_quantity < t_avg_quantity,,)
Time :0.561 ] 

 
2.614 [ Query :Query(-- explain formatted 
with tmp1 as (
    select p_partkey from part where p_name like 'forest%'
),
tmp2 as (
    select s_name, s_address, s_suppkey
    from supplier, nation
    where s_nationkey = n_nationkey
    and n_name = 'CANADA'
),
tmp3 as (
    select l_partkey, 0.5 * sum(l_quantity) as sum_quantity, l_suppkey
    from lineitem, tmp2
    where l_shipdate >= cast('1994-01-01' as timestamp) and l_shipdate <= cast('1995-01-01' as timestamp)
    and l_suppkey = s_suppkey 
    group by l_partkey, l_suppkey
),
tmp4 as (
    select ps_partkey, ps_suppkey, ps_availqty
    from partsupp 
    where ps_partkey IN (select p_partkey from tmp1)
),
tmp5 as (
select
    ps_suppkey
from
    tmp4, tmp3
where
    ps_partkey = l_partkey
    and ps_suppkey = l_suppkey
    and ps_availqty > sum_quantity
)
select
    s_name,
    s_address
from
    supplier
where
    s_suppkey IN (select ps_suppkey from tmp5)
order by s_name,,)
Time :2.614 ] 

 
122.473 [ Query :Query(select o_custkey from orders where O_ORDERSTATUS = 'F' and o_custkey >= 143695 limit 10,,)
Time :122.473 ] 

 
18.506 [ Query :Query(select o_custkey from orders where O_ORDERSTATUS = 'F' and o_custkey >= 143695 limit 10,,)
Time :18.506 ] 

 
11.777
11.643
5.161
8.585
2.975
3.578
1.547
7.002
20.99
6.794
3.077
9.556
1.097
4.441
0.59
2.092
10.289
7.615
3.647
4.618
3.432
3.236
0.33
4.513
21.115
5.253
2.937
9.945
1.481
7.659
1.554
4.421
11.055
6.475
3.594
5.382
3.151
3.368
0.339
3.531
17.586
4.347
2.717
6.779
0.784
3.454
3.277
3.908
6.788
5.536
3.141
3.366
2.609
2.531
0.466
3.086
17.963
4.524
2.687
7.261
0.801
3.147
0.669
2.255
9.788
5.907
3.275
4.028
2.46
4.671
0.443
3.384
21.853
5.203
2.628
8.063
1.099
5.352
1.143
3.096
8.522
6.545
4.486
5.357
3.558
5.521
0.859
6.156
21.581
4.969
2.863
8.554
0.777
3.507
0.886
2.961
15.019
8.256
3.546
4.248
0.319
3.746
18.611
4.742
3.001
9.105
1.286
3.139
0.636
4.86
9.422
6.139
3.68
3.95
0.339
4.176
19.402
3.874
2.959
7.597
0.79
3.225
0.56
2.529
7.895
5.468
3.118
3.561
0.297
3.407
17.842
4.138
2.841
7.126
0.764
3.478
1.01
2.829
10.115
5.48
2.983
3.798
0.329
3.149
17.162
4.245
2.478
6.432
0.694
2.331
0.474
2.093
4.741
6.783
3.442
3.698
0.277
3.68
19.646
3.724
2.449
6.792
0.671
2.412
0.648
2.187
6.739
5.619
3.15
3.217
0.337
3.107
18.279
4.086
2.455
6.281
0.68
2.406
0.815
2.372
5.893
5.271
3.19
3.133
0.239
3.326
18.397
3.979
2.486
6.271
0.719
2.71
0.592
2.175
6.573
6.125
3.415
3.985
0.374
3.98
18.677
4.134
2.742
6.756
0.894
2.923
0.513
3.398
386.658
5.001
6.589
4.997
4.929
7.947 [ Query :Query(select * from testdb.testtable,,)
Time :6.79 ] 

  [ Query :Query(select * from testdb.testtable,,)
Time :244.979 ] 

  [ Query :Query(select * from testdb.testtable,,)
Time :176.573 ] 

  [ Query :Query(select * from testdb.testtable,,)
Time :4.587 ] 

 